-- veritabanini tablolar pk,fk ve verilerle kurma

/* ADIM 1: Tablolari Silme (Varsa)                       */

DROP TABLE IF EXISTS diller CASCADE;
DROP TABLE IF EXISTS ulkeler CASCADE;
DROP TABLE IF EXISTS sehirler CASCADE;
DROP TABLE IF EXISTS ulke_dil CASCADE;
DROP TABLE IF EXISTS model_turleri CASCADE;
DROP TABLE IF EXISTS hastane_turleri CASCADE;
DROP TABLE IF EXISTS kullanici_turleri CASCADE;
DROP TABLE IF EXISTS seviyeler CASCADE;
DROP TABLE IF EXISTS modeller CASCADE;
DROP TABLE IF EXISTS model_ulke CASCADE;
DROP TABLE IF EXISTS model_seviye CASCADE;
DROP TABLE IF EXISTS model_hastane_turu CASCADE;
DROP TABLE IF EXISTS model_kullanici_kapsami CASCADE;
DROP TABLE IF EXISTS boyutlar CASCADE;
DROP TABLE IF EXISTS kriterler CASCADE;
DROP TABLE IF EXISTS gostergeler CASCADE;
DROP TABLE IF EXISTS gosterge_cevap_turleri CASCADE;
DROP TABLE IF EXISTS gosterge_cevap_sablonlari CASCADE;
DROP TABLE IF EXISTS gosterge_cevaplari CASCADE;
DROP TABLE IF EXISTS gosterge_cevabina_oneriler CASCADE;
DROP TABLE IF EXISTS eslesmeler CASCADE;
DROP TABLE IF EXISTS karsilanma_duzeyi CASCADE;

------------------------------------------------ 
------------------------------------------------ 
------------------------------------------------ 
DROP TABLE IF EXISTS kullanicilar CASCADE;
DROP TABLE IF EXISTS hastaneler CASCADE;
DROP TABLE IF EXISTS hastane_model CASCADE;
DROP TABLE IF EXISTS hastane_model_kullanicilar CASCADE;
DROP TABLE IF EXISTS roller CASCADE;
DROP TABLE IF EXISTS yetkiler CASCADE;
DROP TABLE IF EXISTS rol_yetki CASCADE;
DROP TABLE IF EXISTS kullanici_rol CASCADE;



------------------------------------------------ 
------------------------------------------------ 

/* ADIM 2: Tablolar ve Birincil Anahtar (PK) Oluşumu     */


-- diller tablosu 
-- Amac: Desteklenen dillerin temel listesini tutar 

CREATE TABLE diller (
    dil_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  
    dil_adi VARCHAR(64) NOT NULL,
    dil_kodu VARCHAR(16),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ                        
);


-- ulkeler tablosu 
-- Amac: Ulkelerin listesini tutar

CREATE TABLE ulkeler (
    ulke_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  
    ulke_adi VARCHAR(64)  NOT NULL,  
    ulke_kodu VARCHAR(8),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ
);


-- sehirler tablosu 
-- Amac: Her ulkeye bagli sehirleri tanimlar. Bolge, NUTS gibi siniflandirma bilgileri icerir.

CREATE TABLE sehirler (
    sehir_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  
    ulke_id INTEGER NOT NULL,               -- FK: ulkeler tablosuna bağlanır
    sehir_adi VARCHAR(64) NOT NULL,         
    bolge_adi VARCHAR(64),         
    nuts_adi VARCHAR(5),  
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ
);


-- ulke_dil tablosu
-- Amac: Her ulkenin birden fazla dili olabilir ama yalnizca bir tanesi varsayilan olabilir.

CREATE TABLE ulke_dil (
    ulke_dil_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  
    ulke_id INTEGER,             -- FK: ulkeler tablosu
    dil_id INTEGER,              -- FK: diller tablosu
    varsayilan BOOLEAN,          -- TRUE ise ulke icin varsayilan dil
    -- Not: Uygulama düzeyinde constraint eklenmeli → Bir ulke icin yalnizca 1 varsayilan dil olabilir
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ
);


-- model_turu tablosu
-- Amac: Model turu bilgilerini tutar (orn: Puan esaslı, Seviye esaslı)

CREATE TABLE model_turleri (
    model_turu_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    model_turu_adi VARCHAR(32),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ
);


-- hastane_turleri tablosu
-- Amac: Hastane turlerini ve hiyerarsik yapisini tanimlar

CREATE TABLE hastane_turleri (
    hastane_turu_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_hastane_turu_id INTEGER,    -- recursive FK (dil desteği)
    hastane_turu_adi VARCHAR(128),
    dil_adi VARCHAR(64),  
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ         
);


-- kullanici_turleri tablosu
-- Amac: Kullanici turlerini ve aciklamalarini saklar

CREATE TABLE kullanici_turleri (
    kullanici_turu_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_kullanici_turu_id INTEGER,   -- recursive FK (dil desteği)
    kullanici_turu_adi VARCHAR(64),
    aciklama TEXT,
    dil_adi VARCHAR(64),  
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ            
);


-- seviyeler tablosu 
-- Ayni seviye, farkli dillerde gosterilebilir (orn: 'Seviye 1' → 'Level 1')

CREATE TABLE seviyeler (
    seviye_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_seviye_id INTEGER,      -- recursive FK (dil desteği)
    seviye_adi VARCHAR(32),     
    dil_adi VARCHAR(64),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ          
);


-- modeller tablosu 
/* ------------------------------------------------

- ust_model_id(recursive FK) Kendi kendine bağlanır 
- ON DELETE SET NULL: Üst model silinirse, alt modeller kopmaz ama ust_model_id boş kalır
- ON UPDATE CASCADE: Üst modelin model_id'si değişirse (normalde değişmez ama güvenlik için), bağlı alt modeller de güncellenir
-- NOT NULL: kaldırıldı (geliştirme aşamasında esnek kalsın)
------------------------------------------------ */

CREATE TABLE modeller (
    model_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_model_id INTEGER,             -- recursive FK (dil desteği)
    model_turu_id INTEGER,            -- FK model_turu tablosu
    model_resmi_adi VARCHAR(128),     
    model_alias_adi VARCHAR(128),
    model_aciklama TEXT,
	kullanici_kapsami VARCHAR(32),  -- 'Tek' veya 'Coklu' değerleri
    aktif SMALLINT,                    -- 0: pasif, 1: aktif, 2: taslak
    devreye_alma_tarihi TIMESTAMPTZ,
    devreden_kaldirilma_tarihi TIMESTAMPTZ,
    dil_adi VARCHAR(64),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ                
);


-- model_ulke tablosu
-- Amaç: Bir modelin hangi ülkelerde devreye alındığını ve aktiflik durumunu izlemek.
-- Bu yapı sayesinde model bazlı ülke yayılımı, dil ve geçerlilik kontrolü sağlanır.

CREATE TABLE model_ulke (
    model_ulke_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ulke_id INTEGER,                -- FK: ulkeler tablosu
    model_id INTEGER,               -- FK: modeller tablosu
    devreye_alma_tarihi TIMESTAMPTZ,       -- Modelin ilgili ülkedeki devreye giriş tarihi
    dil_adi VARCHAR(64),            -- Modelin bu ülkede kullanılacağı dil (görsel/tanımlayıcı amaçlı)
    aktif BOOLEAN,  --DEFAULT FALSE  -- 0: atanmış ama geçerli değil, 1: devrede
    -- Not: İlk kayıt açıldığında aktif=false olarak gelir, manuel onay süreci sonunda aktif=true yapılır
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ   
);


-- model_seviye tablosu
-- Amaç: Her modelin sahip olabileceği seviyeleri ilişkilendirmek için kullanılır.

CREATE TABLE model_seviye (
    model_seviye_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    model_id INTEGER,      -- FK: modeller tablosu
    seviye_id INTEGER,       -- FK: seviyeler tablosu
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ   
);


-- model_hastane_turu tablosu
-- Amaç: Modellerin hangi hastane türlerine uygulanabilir olduğunu tanımlar.
-- N-N ilişki yapısı kurulur: bir model birden fazla hastane türüne, bir hastane türü birden fazla modele ait olabilir.

CREATE TABLE model_hastane_turu (
    model_hastane_turu_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    model_id INTEGER,            -- FK: modeller tablosu
    hastane_turu_id INTEGER,      -- FK: hastane_turleri tablosu
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ   
);


-- model_kullanici_kapsami tablosu
-- Amaç: Bir modelin hangi kullanıcı türlerine göre özelleştirileceğini tanımlar.
-- N-N ilişki kurulur: bir model birden fazla kullanıcı türünü kapsayabilir.

CREATE TABLE model_kullanici_kapsami (
    model_kullanici_kapsami_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    kullanici_turu_id INTEGER,  -- FK: kullanici_turleri tablosu
    model_id INTEGER,             -- FK: modeller tablosu
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ   
);


-- boyutlar tablosu 
-- Amaç: Modellerin yapısal bileşenleri olan boyutları tanımlar.
/* ------------------------------------------------
ust_boyut_id INTEGER,
 Aynı boyutun farklı dildeki karşılıklarını birbirine bağlar (recursive FK).
 Örn: "Patient Safety" → "Hasta Güvenliği"
 Ana boyut, Türkçe tanım olur; diğer diller üst boyuta referans verir.

boyut_id_hiyerarsi INTEGER,
 Boyutlar arası hiyerarşik bağlantıyı kurar (kategori / alt kategori).
 Örn: "Hasta Güvenliği" alt boyut olarak "Kalite Yönetimi"ne bağlıysa, burada o üst boyutun ID’si yazılır.
 Frontend TreeView ve yapısal filtreleme için kullanılır.
------------------------------------------------ */

CREATE TABLE boyutlar (
    boyut_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_boyut_id INTEGER,              -- recursive FK (dil desteği)
    boyut_id_hiyerarsi INTEGER,        
    boyut_adi VARCHAR(255) ,   		
    boyut_allias VARCHAR(255) ,		
    boyut_etiketleri TEXT,             
    hiyerarsi INTEGER,                 -- Frontend TreeView bileşeni için hiyerarşik seviye (görsel)
    aktif SMALLINT,                    -- 0: pasif, 1: aktif, 2: taslak
    dil_adi VARCHAR(64),                -- Çok dilli destek
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ   
);


-- kriterler tablosu *
-- Amaç: Boyutlara bağlı değerlendirilecek kriterleri tanımlar.

CREATE TABLE kriterler (
    kriter_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_kriter_id INTEGER,          -- recursive FK (dil desteği)
    kriter_adi TEXT,                
    kriter_alias VARCHAR(128),       
    kriter_etiketleri TEXT,         
    dil_adi VARCHAR(64),            
    aktif SMALLINT,                  -- 0: pasif, 1: aktif, 2: taslak
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ   
);


-- gostergeler tablosu *
-- Amaç: Kriterlere bağlı değerlendirici soruların (göstergelerin) tanımını yapar.

CREATE TABLE gostergeler (
    gosterge_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_gosterge_id INTEGER,           -- recursive FK (dil desteği)
	gosterge_adi TEXT ,             
    gosterge_allias VARCHAR(255),      
    gosterge_etiketleri TEXT,          
    gosterge_aciklamasi TEXT,          
    gosterge_ornek_uygulama TEXT,      
    dil_adi VARCHAR(64), 
    aktif SMALLINT,
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ                        -- 0: pasif, 1: aktif, 2: taslak
);


-- gosterge_cevap_turleri tablosu *
-- Amaç: Göstergelere ait cevap türlerini tanımlar (ör: Evet/Hayır, Likert vb.)

CREATE TABLE gosterge_cevap_turleri (
    gosterge_cevap_turu_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    gosterge_cevap_turu VARCHAR(64),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ    
    
);


-- gosterge_cevap_sablonlari tablosu *
-- Amaç: Göstergelere bağlı ön tanımlı cevap şablonlarını tanımlar.
-- Aynı gösterge için farklı cevap türlerinde (Likert, Evet/Hayır vb.) farklı şablonlar oluşturulabilir.

CREATE TABLE gosterge_cevap_sablonlari (
    gosterge_cevap_sablonu_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_gosterge_cevap_sablonu_id INTEGER, -- recursive FK (dil desteği)
    gosterge_cevap_turu_id INTEGER,        -- FK: gosterge_cevap_turu tablosu
    gosterge_cevap_sablon_adi VARCHAR(64), 
    gosterge_cevap_adi VARCHAR(128),        
    gosterge_cevap_puani INTEGER,          
    dil_adi VARCHAR(64),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ   
);


-- gosterge_cevaplari tablosu 
-- Amaç: Modelde kullanılacak göstergelerin cevaplarını tanımlar.
-- Cevaplar kullanıcı türüne göre farklılık gösterebilir. Puanlama, gösterim sırası ve önem düzeyi içerir.

CREATE TABLE gosterge_cevaplari (
    gosterge_cevap_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_gosterge_cevap_id INTEGER,       -- recursive FK (dil desteği)
    gosterge_id INTEGER,                 -- FK: gostergeler  tablosu
    gosterge_cevap_turu_id INTEGER,      -- FK: gosterge_cevap_turu tablosu
    kullanici_turu_id INTEGER,           -- FK: kullanici_turleri tablosu
    gosterge_cevap_onemi VARCHAR(32),    -- Minör, Majör, Zorunlu vb.
    gosterge_cevap_adi VARCHAR(128),      -- Seçenek metni
    gosterge_cevap_puani INTEGER,        -- Bu seçeneğe karşılık gelen puan
    gosterim_sirasi SMALLINT,             -- UI’da gösterim sırası ? eslesmeler tablosunda da var
    dil_adi VARCHAR(50),
    aktif SMALLINT,
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ                         -- 0: pasif, 1: aktif, 2: taslak
);


-- gosterge_cevabina_oneriler tablosu
-- Amaç: Belirli bir gösterge cevabı için kullanıcıya önerilen iyileştirme veya örnek uygulama cümlelerini tanımlar.
-- Her kullanıcı türü için farklı öneriler sunulabilir. Çok dilli destek içerir.

CREATE TABLE gosterge_cevabina_oneriler (
    gosterge_cevabina_oneriler_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_gosterge_cevabina_oneriler_id INTEGER,  -- recursive FK (dil desteği)
    gosterge_cevap_id INTEGER,                  -- FK: gosterge_cevaplari tablosu
    kullanici_turu_id INTEGER,                  -- FK: kullanici_turleri tablosu
    gosterge_cevabina_oneri TEXT,      
    dil_adi VARCHAR(64),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ                            
);


-- eslesmeler tablosu
-- Amaç: Model, boyut, kriter, gösterge ve ilgili cevapların sistemde nasıl eşleştiğini tanımlar.

CREATE TABLE eslesmeler (
    eslesme_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    model_id INTEGER,                           -- FK: modeller tablosu
    boyut_id INTEGER,                           -- FK: boyutlar tablosu
    kriter_id INTEGER,                          -- FK: kriterler tablosu
    seviye_id INTEGER,                          -- FK: seviyeler (karşılanma düzeyi için) tablosu
    gosterge_id INTEGER,                        -- FK: gostergeler tablosu
    gosterge_cevap_id INTEGER,                  -- FK: gosterge_cevaplari tablosu
    gosterge_cevabina_oneriler_id INTEGER,      -- FK: gosterge_cevabina_oneriler tablosu
    kullanici_turu_id INTEGER,                  -- FK: kullanici_turleri tablosu
    turu VARCHAR(64),                           -- Eşleşme türü → 'Model', 'Boyut', 'Kriter' vb.
    agirligi INTEGER,                           -- Ağırlık değeri (puanlama/öncelik için)
    gosterim_sirasi SMALLINT,                   -- Görsel sıralama için
    aciklama TEXT,
    aktif SMALLINT,
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ                                 -- 0: pasif, 1: aktif, 2: taslak
);


-- karsilanma_duzeyi tablosu
-- Amaç: Eşleşmelerin hangi puan aralıklarında hangi seviyeyi veya metinsel karşılanma düzeyini temsil ettiğini tanımlar.

CREATE TABLE karsilanma_duzeyi (
    karsilanma_duzeyi_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ust_karsilanma_duzeyi_id INTEGER,            -- recursive FK (dil desteği)
    eslesme_id INTEGER,                          -- FK: eslesmeler tablosu
    seviye_id INTEGER,                           -- FK: seviyeler (opsiyonel: karşılık gelen seviye)
    turu VARCHAR(64),                            -- 'Model', 'Boyut', 'Kriter' vb.
    maksimum_puan INTEGER,
    minimum_puan INTEGER,
    karsilanma_duzeyi VARCHAR(64),              -- Örnek: 'Tamamen Karşılıyor'
    dil_adi VARCHAR(64),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ                            
);

------------------------------------------------ 
------------------------------------------------ 
------------------------------------------------ 

-- kullanicilar tablosu
-- Amaç: Sisteme kayıt olan kullanıcıların temel bilgilerini, iletişim tercihlerini ve dil seçeneklerini saklamak

CREATE TABLE kullanicilar (
    kullanici_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ulke_id INTEGER ,                            -- FK: ulkeler tablosu
    kullanici_turu_id INTEGER,                   -- FK: kullanici_turleri tablosu
    kullanici_adi VARCHAR(64),
    kullanici_soyadi VARCHAR(64) ,
    sifre VARCHAR(64) ,                          -- NOT: hash'lenmiş halde saklanmalı!
    e_posta VARCHAR(64),
    e_posta_dogrulandi BOOLEAN,                  -- DEFAULT FALSE
    mobil_telefon VARCHAR(32),
    irtibat_tercihi VARCHAR(32),                 -- 'Telefon' | 'ePosta' (UI'de ikonla gösterilecek)
    unvan VARCHAR(64),                           -- Hekim, Hemşire, BT Uzmanı vb.
    arayuz_dil_adi VARCHAR(64),                  -- UI dili (örn. Türkçe, English)
    dil_adi VARCHAR(64),                         -- Anket/model dili
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ                             
);


-- hastaneler tablosu
-- Amaç: Sistem kapsamındaki hastane kayıtlarını saklamak. 

CREATE TABLE hastaneler (
    hastane_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ulke_id INTEGER,                             -- FK: ulkeler
    sehir_id INTEGER,                            -- FK: sehirler
    hastane_turu_id INTEGER,                     -- FK: hastane_turleri
    hastane_adi VARCHAR(255),
    kurulus_yili SMALLINT,
    hastane_eczanesi BOOLEAN,                    -- Eczanesi var mı
    ayaktan_tedavi BOOLEAN,
    yatarak_tedavi BOOLEAN,
    yatak_sayisi SMALLINT,
    acil_servis BOOLEAN,
    acil_servis_seviyesi VARCHAR(32),            -- '1. Seviye', '2. Seviye', '3. Seviye'
    ybu BOOLEAN,                                 -- Yoğun Bakım Ünitesi var mı
    ybu_yatak_sayisi SMALLINT,
    ybu_seviyesi VARCHAR(32),                    -- '1. Seviye', '2. Seviye', '3. Seviye'
    aktif BOOLEAN,
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ  
);


-- hastane_model tablosu
-- Amaç: Hangi modelin hangi hastaneye, hangi dilde ve ne zaman atandığını takip etmek

CREATE TABLE hastane_model (
    hastane_model_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    hastane_id INTEGER,                          -- FK: hastaneler
    model_id INTEGER,                            -- FK: modeller
    dil_adi VARCHAR(50),                         -- Bu modelin hangi dilde verileceği
    atanma_tarihi TIMESTAMPTZ,
    -- atamayi_yapan INTEGER,                       -- FK: kullanici_id (atanan kişi)
    son_gecerlilik_tarihi TIMESTAMPTZ,                  -- Anketin geçerlilik süresi
    aktif BOOLEAN DEFAULT TRUE,
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ  
);


-- hastane_model_kullanicilar tablosu
-- Amaç: Bir hastane için atanmış modele hangi kullanıcıların veya delegelerin tanımlandığını belirtmek

CREATE TABLE hastane_model_kullanicilar (
    hastane_model_kullanici_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    hastane_model_id INTEGER,                    -- FK: hastane_model
    kullanici_id INTEGER,                        -- FK: kullanicilar (eğer kayıtlı kullanıcıysa)
    kullanici_turu_id INTEGER,                   -- FK: kullanici_turleri
    kayitli_kullanici BOOLEAN ,     			  -- Evetse sistemde kayıtlı kullanıcıdır
    delege_kullanici_adi VARCHAR(128),           -- Kayıtsızsa manuel girilen ad-soyad
    delege_kullanici_eposta VARCHAR(64),         -- Kayıtsızsa manuel girilen e-posta
    anket_url TEXT,                              -- Her kullanıcıya özel oluşturulan anket bağlantısı
    delagasyon_tarihi TIMESTAMPTZ,                       -- Kullanıcıya atanma tarihi
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ  
);


-- roller tablosu
-- Amaç: Sistemdeki kullanıcı rollerini tanımlar.
CREATE TABLE roller (
    rol_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    rol_kodu VARCHAR(64) ,
    rol_adi VARCHAR(128),
    aciklama TEXT,
    aktif BOOLEAN,
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ  
);


-- yetkiler tablosu
-- Amaç: Sistemdeki en temel izinleri (aksiyonları) tanımlar.
CREATE TABLE yetkiler (
    yetki_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    yetki_kodu VARCHAR(128) UNIQUE ,
    yetki_adi VARCHAR(255),
    kategori VARCHAR(128),
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64),
    guncelleme_zamani   TIMESTAMPTZ,
    guncelleyen_kisi    VARCHAR(64),
    -- Soft delete icin
    silindi_mi          BOOLEAN NOT NULL DEFAULT FALSE,
    silinme_tarihi      TIMESTAMPTZ  
);


-- rol_yetkileri tablosu (Junction Table)
-- Amaç: Roller ile yetkiler arasındaki N-N (çoka-çok) ilişkiyi kurar.
CREATE TABLE rol_yetki (
    rol_yetki_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    rol_id INTEGER,
    yetki_id INTEGER ,
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64)

);

CREATE TABLE kullanici_rol (
    kullanici_rol_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    kullanici_id INTEGER NOT NULL REFERENCES kullanicilar(kullanici_id) ON DELETE CASCADE,
    rol_id INTEGER NOT NULL REFERENCES roller(rol_id) ON DELETE CASCADE,
    -- Audit log icin
    olusturma_zamani    TIMESTAMPTZ NOT NULL DEFAULT now(),
    olusturan_kisi      VARCHAR(64)
);

------------------------------------------------ 
------------------------------------------------ 

/* ADIM 3:  TABLOLARIN FOREIGN KEY ALANLARININ EKLENMESİ */



/* sehirler TABLOSUNA FOREIGN KEY EKLEMEK */

--  sehirler -> ulkeler icin foreign key ekle
ALTER TABLE sehirler
  ADD CONSTRAINT fk_sehirler_ulkeler_ulke_id
  FOREIGN KEY (ulke_id) REFERENCES ulkeler(ulke_id)
  ON DELETE RESTRICT;          


/* ulke_dil TABLOSUNA FOREIGN KEY EKLEMEK 
-- ulkedil: ulke_dil tablosu icin kisaltma */

-- ulke_dil -> ulkeler için foreign key ekle
ALTER TABLE ulke_dil
ADD CONSTRAINT fk_ulkedil_ulkeler_ulke_id
FOREIGN KEY (ulke_id) REFERENCES ulkeler(ulke_id)
ON DELETE RESTRICT;

-- ulke_dil ->  diller için foreign key ekle
ALTER TABLE ulke_dil
ADD CONSTRAINT fk_ulkedil_diller_dil_id
FOREIGN KEY (dil_id) REFERENCES diller(dil_id)
ON DELETE RESTRICT;

-- ? Model turleri tablosu icin recursive baglanti gerekli mi?

/* hastane_turleri TABLOSUNA FOREIGN KEY EKLEMEK 
 hastur: hastane_turleri tablosu icin kisaltma */

-- hastane_turleri -> dil destegi icin recursive foreign key
ALTER TABLE hastane_turleri
ADD CONSTRAINT fk_hastur_ust_hastane_turu_id
FOREIGN KEY (ust_hastane_turu_id) REFERENCES hastane_turleri(hastane_turu_id)
ON DELETE RESTRICT;        

/* kullanici_turleri TABLOSUNA FOREIGN KEY EKLEMEK 
 kultur: kullanici_turleri tablosu icin kisaltma */

-- kullanici_turleri -> dil destegi icin recursive foreign key
ALTER TABLE kullanici_turleri
ADD CONSTRAINT fk_kultur_ust_kullanici_turu_id
FOREIGN KEY (ust_kullanici_turu_id) REFERENCES kullanici_turleri(kullanici_turu_id)
ON DELETE RESTRICT;       


/* seviyeler TABLOSUNA FOREIGN KEY EKLEMEK */

ALTER TABLE seviyeler
ADD CONSTRAINT fk_seviyeler_ust_seviye_id
FOREIGN KEY (ust_seviye_id) REFERENCES seviyeler(seviye_id)
ON DELETE RESTRICT;


/* modeller TABLOSUNA FOREIGN KEY EKLEMEK 
-- modtur: modeller tablosu icin kisaltma */

-- modeller -> dil destegi icin recursive foreign key
ALTER TABLE modeller
ADD CONSTRAINT fk_modeller_ust_model_id
FOREIGN KEY (ust_model_id) REFERENCES modeller(model_id)
ON DELETE RESTRICT;    

-- modeller -> model_turleri icin foreign key
ALTER TABLE modeller
ADD CONSTRAINT fk_modeller_modtur_model_turu_id
FOREIGN KEY (model_turu_id) REFERENCES model_turleri(model_turu_id)
ON DELETE RESTRICT;


/* model_ulke TABLOSUNA FOREIGN KEY EKLEMEK 
-- modulke: model_ulke tablosu icin kisaltma */

-- model_ulke -> ulkeler icin foreign key
ALTER TABLE model_ulke
  ADD CONSTRAINT fk_modulke_ulkeler_ulke_id
  FOREIGN KEY (ulke_id) REFERENCES ulkeler(ulke_id)
  ON DELETE RESTRICT;

-- model_ulke -> modeller icin foreign key
ALTER TABLE model_ulke
  ADD CONSTRAINT fk_modulke_modeller_model_id
  FOREIGN KEY (model_id) REFERENCES modeller(model_id)
  ON DELETE RESTRICT;


/* model_seviye TABLOSUNA FOREIGN KEY EKLEMEK 
-- modseviye: model_seviye tablosu icin kisaltma */

-- model_seviye -> modeller icin foreign key
ALTER TABLE model_seviye
  ADD CONSTRAINT fk_modseviye_modeller_model_id
  FOREIGN KEY (model_id) REFERENCES modeller(model_id)
  ON DELETE RESTRICT;

-- model_seviye -> seviyeler icin foreign key
ALTER TABLE model_seviye
  ADD CONSTRAINT fk_modseviye_seviyeler_seviye_id
  FOREIGN KEY (seviye_id) REFERENCES seviyeler(seviye_id)
  ON DELETE RESTRICT;


/* model_hastane_turu TABLOSUNA FOREIGN KEY EKLEMEK 
-- modhastur: model_hastane_turu tablosu icin kisaltma 
-- hastur: hastane_turleri tablosu icin kisaltma */

-- model_hastane_turu -> modeller icin foreign key
ALTER TABLE model_hastane_turu
  ADD CONSTRAINT fk_modhastur_modeller_model_id
  FOREIGN KEY (model_id) REFERENCES modeller(model_id)
  ON DELETE RESTRICT;

-- model_hastane_turu -> hastane_turleri icin foreign key
ALTER TABLE model_hastane_turu
  ADD CONSTRAINT fk_modhastur_hastur_hastane_turu_id
  FOREIGN KEY (hastane_turu_id) REFERENCES hastane_turleri(hastane_turu_id)
  ON DELETE RESTRICT;


/* model_kullanici_kapsami TABLOSUNA FOREIGN KEY EKLEMEK 
-- modkulkapsam: model_kullanici_kapsami tablosu icin kisaltma 
-- kultur: kullanici_turleri tablosu icin kisaltma */

-- model_kullanici_kapsami -> modeller icin foreign key
ALTER TABLE model_kullanici_kapsami
  ADD CONSTRAINT fk_modkulkapsam_modeller_model_id
  FOREIGN KEY (model_id) REFERENCES modeller(model_id)
  ON DELETE RESTRICT;

-- model_kullanici_kapsami -> kullanici_turleri icin foreign key
ALTER TABLE model_kullanici_kapsami
  ADD CONSTRAINT fk_modkulkapsam_kultur_kullanici_turu_id
  FOREIGN KEY (kullanici_turu_id) REFERENCES kullanici_turleri(kullanici_turu_id)
  ON DELETE RESTRICT;


/* boyutlar TABLOSUNA FOREIGN KEY EKLEMEK */

-- boyutlar -> dil destegi icin recursive foreign key
ALTER TABLE boyutlar
  ADD CONSTRAINT fk_boyutlar_ust_boyut_id
  FOREIGN KEY (ust_boyut_id) REFERENCES boyutlar(boyut_id)
  ON DELETE RESTRICT;

-- boyutlar -> hiyerarsi icin reccursive foreign key
ALTER TABLE boyutlar
  ADD CONSTRAINT fk_boyutlar_boyut_id_hiyerarsi
  FOREIGN KEY (boyut_id_hiyerarsi) REFERENCES boyutlar(boyut_id)
  ON DELETE RESTRICT;


/* kriterler TABLOSUNA FOREIGN KEY EKLEMEK */

-- kriterler -> dil destegi icin recursive foreign key
ALTER TABLE kriterler
  ADD CONSTRAINT fk_kriterler_ust_kriter_id
  FOREIGN KEY (ust_kriter_id) REFERENCES kriterler(kriter_id)
  ON DELETE RESTRICT;


/* gostergeler TABLOSUNA FOREIGN KEY EKLEMEK */

-- gostergeler -> dil destegi icin recursive foreign key
ALTER TABLE gostergeler
  ADD CONSTRAINT fk_gostergeler_ust_gosterge_id
  FOREIGN KEY (ust_gosterge_id) REFERENCES gostergeler(gosterge_id)
  ON DELETE RESTRICT;


/* gosterge_cevap_sablonlari TABLOSUNA FOREIGN KEY EKLEMEK 
-- goscvpsablon: gosterge_cevap_sablonlari tablosu icin kisaltma 
-- goscvptur: gosterge_cevap_turleri tablosu icin kisaltma */

-- gosterge_cevap_sablonu -> dil destegi icin recursive foreign key
ALTER TABLE gosterge_cevap_sablonlari
  ADD CONSTRAINT fk_goscvpsablon_ust_gosterge_cevap_sablonu_id
  FOREIGN KEY (ust_gosterge_cevap_sablonu_id)
  REFERENCES gosterge_cevap_sablonlari(gosterge_cevap_sablonu_id)
  ON DELETE RESTRICT;

-- gosterge_cevap_sablonlari -> gosterge_cevap_turleri icin foreign key
ALTER TABLE gosterge_cevap_sablonlari
  ADD CONSTRAINT fk_goscvpsablon_goscvptur_gosterge_cevap_turu_id
  FOREIGN KEY (gosterge_cevap_turu_id)
  REFERENCES gosterge_cevap_turleri(gosterge_cevap_turu_id)
  ON DELETE RESTRICT;


/* gosterge_cevaplari TABLOSUNA FOREIGN KEY EKLEMEK 
-- goscevap: gosterge_cevaplari tablosu icin kisaltma 
-- goscvptur: gosterge_cevap_turleri tablosu icin kisaltma 
-- kultur: kullanici_turleri tablosu icin kisaltma */

-- gosterge_cevaplari -> dil destegi icin recursive foreign key
ALTER TABLE gosterge_cevaplari
  ADD CONSTRAINT fk_goscevap_ust_gosterge_cevap_id
  FOREIGN KEY (ust_gosterge_cevap_id)
  REFERENCES gosterge_cevaplari(gosterge_cevap_id)
  ON DELETE RESTRICT;

-- gosterge_cevaplari -> gostergeler icin foreign key
ALTER TABLE gosterge_cevaplari
  ADD CONSTRAINT fk_goscevap_gostergeler_gosterge_id
  FOREIGN KEY (gosterge_id)
  REFERENCES gostergeler(gosterge_id)
  ON DELETE CASCADE;

-- gosterge_cevaplari -> gosterge_cevap_turleri icin foreign key
ALTER TABLE gosterge_cevaplari
  ADD CONSTRAINT fk_goscevap_goscvptur_gosterge_cevap_turu_id
  FOREIGN KEY (gosterge_cevap_turu_id)
  REFERENCES gosterge_cevap_turleri(gosterge_cevap_turu_id)
  ON DELETE RESTRICT;

-- gosterge_cevaplari -> kullanici_turleri icin foreign key
ALTER TABLE gosterge_cevaplari
  ADD CONSTRAINT fk_goscevap_kultur_kullanici_turu_id
  FOREIGN KEY (kullanici_turu_id)
  REFERENCES kullanici_turleri(kullanici_turu_id)
  ON DELETE RESTRICT;


/* gosterge_cevabina_oneriler TABLOSUNA FOREIGN KEY EKLEMEK
-- goscvponeri : gosterge_cevabina_oneriler tablosu icin kisaltma
-- kultur : kullanici_turleri tablosu icin kisaltma */

-- gosterge_cevabina_oneriler -> dil destegi icin recursive foreign key
ALTER TABLE gosterge_cevabina_oneriler
  ADD CONSTRAINT fk_goscvponeri_ust_gosterge_cevabina_oneriler_id
  FOREIGN KEY (ust_gosterge_cevabina_oneriler_id)
  REFERENCES gosterge_cevabina_oneriler(gosterge_cevabina_oneriler_id)
  ON DELETE RESTRICT;

-- gosterge_cevabina_oneriler -> gosterge_cevaplari icin foreign key
ALTER TABLE gosterge_cevabina_oneriler
  ADD CONSTRAINT fk_goscvponeri_goscevap_gosterge_cevap_id
  FOREIGN KEY (gosterge_cevap_id)
  REFERENCES gosterge_cevaplari(gosterge_cevap_id)
  ON DELETE RESTRICT;

-- gosterge_cevabina_oneriler -> kullanici_turleri icin foreign key
ALTER TABLE gosterge_cevabina_oneriler
  ADD CONSTRAINT fk_goscvponeri_kultur_kullanici_turu_id
  FOREIGN KEY (kullanici_turu_id)
  REFERENCES kullanici_turleri(kullanici_turu_id)
  ON DELETE RESTRICT;


/* eslesmeler TABLOSUNA FOREIGN KEY EKLEMEK 
-- goscevap: gosterge_cevaplari tablosu icin kisaltma 
-- goscvponeri: gosterge_cevabina_oneriler tablosu icin kisaltma 
-- kultur: kullanici_turleri tablosu icin kisaltma */

-- eslesmeler -> modeller icin foreign key
ALTER TABLE eslesmeler
  ADD CONSTRAINT fk_eslesmeler_modeller_model_id
  FOREIGN KEY (model_id)
  REFERENCES modeller(model_id)
  ON DELETE RESTRICT;

-- eslesmeler -> boyutlar icin foreign key
ALTER TABLE eslesmeler
  ADD CONSTRAINT fk_eslesmeler_boyutlar_boyut_id
  FOREIGN KEY (boyut_id)
  REFERENCES boyutlar(boyut_id)
  ON DELETE RESTRICT;

-- eslesmeler -> kriterler icin foreign key
ALTER TABLE eslesmeler
  ADD CONSTRAINT fk_eslesmeler_kriterler_kriter_id
  FOREIGN KEY (kriter_id)
  REFERENCES kriterler(kriter_id)
  ON DELETE RESTRICT;

-- eslesmeler -> seviyeler icin foreign key
ALTER TABLE eslesmeler
  ADD CONSTRAINT fk_eslesmeler_seviyeler_seviye_id
  FOREIGN KEY (seviye_id)
  REFERENCES seviyeler(seviye_id)
  ON DELETE RESTRICT;

-- eslesmeler -> gostergeler icin foreign key
ALTER TABLE eslesmeler
  ADD CONSTRAINT fk_eslesmeler_gostergeler_gosterge_id
  FOREIGN KEY (gosterge_id)
  REFERENCES gostergeler(gosterge_id)
  ON DELETE RESTRICT;

-- eslesmeler -> gosterge_cevaplari icin foreign key
ALTER TABLE eslesmeler
  ADD CONSTRAINT fk_eslesmeler_goscevap_gosterge_cevap_id
  FOREIGN KEY (gosterge_cevap_id)
  REFERENCES gosterge_cevaplari(gosterge_cevap_id)
  ON DELETE RESTRICT;

-- eslesmeler -> gosterge_cevabina_oneriler icin foreign key 
ALTER TABLE eslesmeler
  ADD CONSTRAINT fk_eslesmeler_goscvponeri_gosterge_cevabina_oneriler_id
  FOREIGN KEY (gosterge_cevabina_oneriler_id)
  REFERENCES gosterge_cevabina_oneriler(gosterge_cevabina_oneriler_id)
  ON DELETE RESTRICT;

-- eslesmeler -> kullanici_turleri icin foreign key
ALTER TABLE eslesmeler
  ADD CONSTRAINT fk_eslesmeler_kultur_kullanici_turu_id
  FOREIGN KEY (kullanici_turu_id)
  REFERENCES kullanici_turleri(kullanici_turu_id)
  ON DELETE RESTRICT;

/* karsilanma_duzeyi TABLOSUNA FOREIGN KEY EKLEMEK 
-- karduzeyi: karsilanma_duzeyi tablosu icin kisaltma */

-- karsilanma_duzeyi -> dil destegi icin recursive foreign key
ALTER TABLE karsilanma_duzeyi
  ADD CONSTRAINT fk_karduzeyi_ust_karsilanma_duzeyi_id
  FOREIGN KEY (ust_karsilanma_duzeyi_id)
  REFERENCES karsilanma_duzeyi(karsilanma_duzeyi_id)
  ON DELETE RESTRICT;

-- karsilanma_duzeyi -> eslesmeler icin foreign key
ALTER TABLE karsilanma_duzeyi
  ADD CONSTRAINT fk_karduzeyi_eslesmeler_eslesme_id
  FOREIGN KEY (eslesme_id)
  REFERENCES eslesmeler(eslesme_id)
  ON DELETE RESTRICT;

-- karsilanma_duzeyi -> seviyeler icin foreign key
ALTER TABLE karsilanma_duzeyi
  ADD CONSTRAINT fk_karduzeyi_seviyeler_seviye_id
  FOREIGN KEY (seviye_id)
  REFERENCES seviyeler(seviye_id)
  ON DELETE RESTRICT;

------------------------------------------------ 
------------------------------------------------ 
------------------------------------------------ 

/* kullanicilar TABLOSUNA FOREIGN KEY EKLEMEK 
kultur: kullanici_turleri tablosu icin kisaltma */

-- kullanicilar -> ulkeler icin foreign key
ALTER TABLE kullanicilar
  ADD CONSTRAINT fk_kullanicilar_ulkeler_ulke_id
  FOREIGN KEY (ulke_id)
  REFERENCES ulkeler(ulke_id)
  ON DELETE RESTRICT;

-- kullanicilar -> kullanici_turleri icin foreign key
ALTER TABLE kullanicilar
  ADD CONSTRAINT fk_kullanicilar_kultur_kullanici_turu_id
  FOREIGN KEY (kullanici_turu_id)
  REFERENCES kullanici_turleri(kullanici_turu_id)
  ON DELETE RESTRICT;


/* hastaneler TABLOSUNA FOREIGN KEY EKLEMEK 
-- hastur: hastaneler tablosu icin kisaltma */

-- hastaneler -> ulkeler icin foreign key
ALTER TABLE hastaneler
  ADD CONSTRAINT fk_hastaneler_ulkeler_ulke_id
  FOREIGN KEY (ulke_id)
  REFERENCES ulkeler(ulke_id)
  ON DELETE RESTRICT;

-- hastaneler -> sehirler icin foreign key
ALTER TABLE hastaneler
  ADD CONSTRAINT fk_hastaneler_sehirler_sehir_id
  FOREIGN KEY (sehir_id)
  REFERENCES sehirler(sehir_id)
  ON DELETE RESTRICT;

-- hastaneler -> hastane_turleri icin foreign key
ALTER TABLE hastaneler
  ADD CONSTRAINT fk_hastaneler_hastur_hastane_turu_id
  FOREIGN KEY (hastane_turu_id)
  REFERENCES hastane_turleri(hastane_turu_id)
  ON DELETE RESTRICT;

/* hastane_model TABLOSUNA FOREIGN KEY EKLEMEK
-- hasmodel: hastane_model tablosu icin kisaltma */

-- hastane_model -> hastaneler icin foreign key
ALTER TABLE hastane_model
  ADD CONSTRAINT fk_hasmodel_hastaneler_hastane_id
  FOREIGN KEY (hastane_id)
  REFERENCES hastaneler(hastane_id)
  ON DELETE RESTRICT;

-- hastane_model -> modeller icin foreign key
ALTER TABLE hastane_model
  ADD CONSTRAINT fk_hasmodel_modtur_model_id
  FOREIGN KEY (model_id)
  REFERENCES modeller(model_id)
  ON DELETE RESTRICT;

/* hastane_model_kullanicilar TABLOSUNA FOREIGN KEY EKLEMEK
-- hasmodkullanici: hastane_model_kullanicilar tablosu icin kisaltma 
-- hasmodel: hastane_model tablosu icin kisaltma 
-- kultur: kullanici_turleri tablosu icin kisaltma */

-- hastane_model_kullanicilar -> hastane_model icin foreign key
ALTER TABLE hastane_model_kullanicilar
  ADD CONSTRAINT fk_hasmodkullanici_hasmodel_hastane_model_id
  FOREIGN KEY (hastane_model_id)
  REFERENCES hastane_model(hastane_model_id)
  ON DELETE RESTRICT;

-- hastane_model_kullanicilar -> kullanicilar icin foreign key  
ALTER TABLE hastane_model_kullanicilar
  ADD CONSTRAINT fk_hasmodkullanici_kullanicilar_kullanici_id
  FOREIGN KEY (kullanici_id)
  REFERENCES kullanicilar(kullanici_id)
  ON DELETE RESTRICT;

-- hastane_model_kullanicilar -> kullanici_turleri icin foreign key
ALTER TABLE hastane_model_kullanicilar
  ADD CONSTRAINT fk_hasmodkullanici_kultur_kullanici_turu_id
  FOREIGN KEY (kullanici_turu_id)
  REFERENCES kullanici_turleri(kullanici_turu_id)
  ON DELETE RESTRICT;


/* rol_yetki TABLOSUNA FOREIGN KEY EKLEMEK */

-- rol_yetkileri -> roller icin foreign key
ALTER TABLE rol_yetki
  ADD CONSTRAINT fk_rolyetki_roller_rol_id
  FOREIGN KEY (rol_id)
  REFERENCES roller(rol_id)
  ON DELETE CASCADE;

-- rol_yetki -> yetkiler icin foreign key
ALTER TABLE rol_yetki
  ADD CONSTRAINT fk_rolyetki_yetkiler_yetki_id
  FOREIGN KEY (yetki_id)
  REFERENCES yetkiler(yetki_id)
  ON DELETE CASCADE;

/* kullanici_rol TABLOSUNA FOREIGN KEY EKLEMEK */

-- kullanici_rol -> kullanicilar icin foreign key

ALTER TABLE kullanici_rol
  ADD CONSTRAINT fk_kullanicirol_kullanicilar_kullanici_id
  FOREIGN KEY (kullanici_id)
  REFERENCES kullanicilar(kullanici_id)
  ON DELETE CASCADE;

-- kullanici_rol -> roller icin foreign key
ALTER TABLE kullanici_rol
  ADD CONSTRAINT fk_kullanicirol_roller_rol_id
  FOREIGN KEY (rol_id)
  REFERENCES roller(rol_id)
  ON DELETE CASCADE;



------------------------------------------------ 
------------------------------------------------ 

/* ADIM 4:  TABLOLARA VERI EKLEME			   */
  

/* diller tablosuna veri ekle */
INSERT INTO diller (dil_adi) VALUES 
('Türkçe'),
('English'),
('Español'),
('Arabic');


/* ulkeler tablosuna veri ekle */
INSERT INTO ulkeler (ulke_adi) VALUES 
('Türkiye'),
('USA'),
('Spain'),
('Saudi Arabia');


/* sehirler tablosuna veri ekle */
INSERT INTO sehirler (ulke_id, sehir_adi, bolge_adi, nuts_adi) VALUES 
(1, 'İstanbul', 'Marmara', 'TR10'),
(1, 'Ankara', 'İç Anadolu', 'TR51'),
(2, 'London', 'Greater London', 'UKI'),
(3, 'Madrid', 'Comunidad de Madrid', 'ES30'),
(4, 'Riyadh', 'Riyadh', 'SA10');


/* ulke_dil tablosuna veri ekle */
INSERT INTO ulke_dil (ulke_id, dil_id, varsayilan) VALUES 
(1, 1, TRUE),     -- Türkiye → Türkçe
(2, 2, TRUE),     -- İngiltere → English
(3, 3, TRUE),     -- İspanya → Español
(4, 4, TRUE),     -- Suudi Arabistan → Arabic
(1, 2, FALSE),    -- Türkiye → English (ikincil dil)
(3, 2, FALSE), -- İspanya → English (ikincil dil)
(4, 2, FALSE);    -- Suudi Arabistan → English (ikincil dil)


/* model_turleri tablosuna veri ekle */
INSERT INTO model_turleri (model_turu_adi) VALUES 
('Puan Esaslı'),
('Seviye Esaslı');



/* ------------------------------------------------
--				ulke dil join

SELECT 
    u.ulke_adi AS "Ülke",
    d.dil_adi AS "Dil",
    CASE 
        WHEN ud.varsayilan = FALSE THEN 'Hayır'
        WHEN ud.varsayilan = TRUE THEN 'Evet'
        ELSE 'Bilinmiyor'
    END AS "Varsayılan dil mi?"
FROM 
    ulke_dil ud
JOIN 
    ulkeler u ON u.ulke_id = ud.ulke_id
JOIN 
    diller d ON d.dil_id = ud.dil_id
ORDER BY 
    u.ulke_adi, ud.varsayilan DESC;
------------------------------------------------ */


/* hastane_turleri tablosuna veri ekle */

-- turkce verileri ekle
INSERT INTO hastane_turleri (ust_hastane_turu_id, hastane_turu_adi, dil_adi) VALUES
(NULL, 'Fizik Tedavi ve Rehabilitasyon Hastanesi', 'Türkçe'),
(NULL, 'Araştırma Hastanesi', 'Türkçe'),
(NULL, 'Ağız ve Diş Sağlığı Merkezi', 'Türkçe'),
(NULL, 'Göz Hastanesi', 'Türkçe'),
(NULL, 'Kadın Doğum Hastanesi', 'Türkçe');


-- 'Fizik Tedavi ve Rehabilitasyon Hastanesi'
WITH base AS (
  SELECT hastane_turu_id
  FROM hastane_turleri
  WHERE hastane_turu_adi = 'Fizik Tedavi ve Rehabilitasyon Hastanesi'
    AND dil_adi = 'Türkçe'
)

INSERT INTO hastane_turleri (ust_hastane_turu_id, hastane_turu_adi, dil_adi)
SELECT base.hastane_turu_id, tr.adi, tr.dil
FROM base,
     (VALUES
        ('Physical Therapy and Rehabilitation Hospital', 'English'),
        ('Hospital de Fisioterapia y Rehabilitación', 'Español'),
        ('مستشفى العلاج الطبيعي وإعادة التأهيل', 'Arabic')
     ) AS tr(adi, dil);

-- ARAŞTIRMA HASTANESİ çevirileri
WITH base AS (
  SELECT hastane_turu_id
  FROM hastane_turleri
  WHERE hastane_turu_adi = 'Araştırma Hastanesi' AND dil_adi = 'Türkçe'
)
INSERT INTO hastane_turleri (ust_hastane_turu_id, hastane_turu_adi, dil_adi)
SELECT base.hastane_turu_id, val.adi, val.dil
FROM base,
     (VALUES
        ('Research Hospital', 'English'),
        ('Hospital de Investigación', 'Español'),
        ('مستشفى البحوث', 'Arabic')
     ) AS val(adi, dil);

-- AĞIZ VE DİŞ SAĞLIĞI MERKEZİ çevirileri
WITH base AS (
  SELECT hastane_turu_id
  FROM hastane_turleri
  WHERE hastane_turu_adi = 'Ağız ve Diş Sağlığı Merkezi' AND dil_adi = 'Türkçe'
)
INSERT INTO hastane_turleri (ust_hastane_turu_id, hastane_turu_adi, dil_adi)
SELECT base.hastane_turu_id, val.adi, val.dil
FROM base,
     (VALUES
        ('Oral and Dental Health Center', 'English'),
        ('Centro de Salud Oral y Dental', 'Español'),
        ('مركز صحة الفم والأسنان', 'Arabic')
     ) AS val(adi, dil);

-- GÖZ HASTANESİ çevirileri
WITH base AS (
  SELECT hastane_turu_id
  FROM hastane_turleri
  WHERE hastane_turu_adi = 'Göz Hastanesi' AND dil_adi = 'Türkçe'
)
INSERT INTO hastane_turleri (ust_hastane_turu_id, hastane_turu_adi, dil_adi)
SELECT base.hastane_turu_id, val.adi, val.dil
FROM base,
     (VALUES
        ('Eye Hospital', 'English'),
        ('Hospital de Ojos', 'Español'),
        ('مستشفى العيون', 'Arabic')
     ) AS val(adi, dil);

-- KADIN DOĞUM HASTANESİ çevirileri
WITH base AS (
  SELECT hastane_turu_id
  FROM hastane_turleri
  WHERE hastane_turu_adi = 'Kadın Doğum Hastanesi' AND dil_adi = 'Türkçe'
)
INSERT INTO hastane_turleri (ust_hastane_turu_id, hastane_turu_adi, dil_adi)
SELECT base.hastane_turu_id, val.adi, val.dil
FROM base,
     (VALUES
        ('Maternity Hospital', 'English'),
        ('Hospital de Maternidad', 'Español'),
        ('مستشفى الولادة', 'Arabic')
     ) AS val(adi, dil);

/* ------------------------------------------------
-- 			join hastane turleri

SELECT 
    CASE 
        WHEN ust.hastane_turu_adi IS NOT NULL THEN ust.hastane_turu_adi
        ELSE alt.hastane_turu_adi
    END AS "Türkçe Ana Ad",
    alt.hastane_turu_adi AS "Çeviri",
    alt.dil_adi AS "Dil"
FROM hastane_turleri AS alt
LEFT JOIN hastane_turleri AS ust
    ON alt.ust_hastane_turu_id = ust.hastane_turu_id
ORDER BY "Türkçe Ana Ad", alt.dil_adi;


-- ustteki kod ile ayni islev fakat daha hizli ilk null degerini dondurur
SELECT 
    COALESCE(ust.hastane_turu_adi, alt.hastane_turu_adi) AS "Türkçe Ana Ad",
    alt.hastane_turu_adi AS "Çeviri",
    alt.dil_adi AS "Dil"
FROM hastane_turleri AS alt
LEFT JOIN hastane_turleri AS ust
    ON alt.ust_hastane_turu_id = ust.hastane_turu_id
ORDER BY "Türkçe Ana Ad", alt.dil_adi;

------------------------------------------------ */

/* kullanici_turleri tablosuna veri ekle */


-- Türkçe
INSERT INTO kullanici_turleri (ust_kullanici_turu_id, kullanici_turu_adi, aciklama, dil_adi) VALUES
(NULL, 'İdari Personel', 'İdari süreçleri yöneten personel', 'Türkçe'),
(NULL, 'Teknik Personel', 'Teknik destek ve sistem yönetimi', 'Türkçe'),
(NULL, 'Tıbbi Personel', 'Sağlık hizmeti sunan personel', 'Türkçe'),
(NULL, 'Genel', 'Tüm kullanıcı türleri', 'Türkçe');


-- idari personel çevirileri
WITH base AS (
  SELECT kullanici_turu_id FROM kullanici_turleri
  WHERE kullanici_turu_adi = 'İdari Personel' AND dil_adi = 'Türkçe'
)
INSERT INTO kullanici_turleri (ust_kullanici_turu_id, kullanici_turu_adi, aciklama, dil_adi)
SELECT base.kullanici_turu_id, val.adi, val.aciklama, val.dil
FROM base,
     (VALUES
        ('Administrative Staff', 'Staff managing administrative processes', 'English'),
        ('Personal Administrativo', 'Personal que gestiona procesos administrativos', 'Español'),
        ('الموظفون الإداريون', 'الموظفون الذين يديرون العمليات الإدارية', 'Arabic')
     ) AS val(adi, aciklama, dil);



-- teknik personel çevirileri
WITH base AS (
  SELECT kullanici_turu_id FROM kullanici_turleri
  WHERE kullanici_turu_adi = 'Teknik Personel' AND dil_adi = 'Türkçe'
)
INSERT INTO kullanici_turleri (ust_kullanici_turu_id, kullanici_turu_adi, aciklama, dil_adi)
SELECT base.kullanici_turu_id, val.adi, val.aciklama, val.dil
FROM base,
     (VALUES
        ('Technical Staff', 'Responsible for technical support and systems', 'English'),
        ('Personal Técnico', 'Responsable de soporte técnico y sistemas', 'Español'),
        ('الموظفون الفنيون', 'المسؤولون عن الدعم الفني وإدارة النظام', 'Arabic')
     ) AS val(adi, aciklama, dil);


-- tıbbi personel çevirileri
WITH base AS (
  SELECT kullanici_turu_id FROM kullanici_turleri
  WHERE kullanici_turu_adi = 'Tıbbi Personel' AND dil_adi = 'Türkçe'
)
INSERT INTO kullanici_turleri (ust_kullanici_turu_id, kullanici_turu_adi, aciklama, dil_adi)
SELECT base.kullanici_turu_id, val.adi, val.aciklama, val.dil
FROM base,
     (VALUES
        ('Medical Staff', 'Staff providing healthcare services', 'English'),
        ('Personal Médico', 'Personal que presta servicios sanitarios', 'Español'),
        ('الطاقم الطبي', 'الموظفون الذين يقدمون خدمات الرعاية الصحية', 'Arabic')
     ) AS val(adi, aciklama, dil);


-- genel çevirileri
WITH base AS (
  SELECT kullanici_turu_id FROM kullanici_turleri
  WHERE kullanici_turu_adi = 'Genel' AND dil_adi = 'Türkçe'
)
INSERT INTO kullanici_turleri (ust_kullanici_turu_id, kullanici_turu_adi, aciklama, dil_adi)
SELECT base.kullanici_turu_id, val.adi, val.aciklama, val.dil
FROM base,
     (VALUES
        ('General', 'Includes all user types', 'English'),
        ('General', 'Incluye todos los tipos de usuarios', 'Español'),
        ('عام', 'يشمل جميع أنواع المستخدمين', 'Arabic')
     ) AS val(adi, aciklama, dil);

/* ------------------------------------------------
-- join		Kullanıcı Türleri Çevirileri

SELECT
    CASE
        WHEN ust.kullanici_turu_adi IS NOT NULL THEN ust.kullanici_turu_adi
        ELSE alt.kullanici_turu_adi
    END AS "Türkçe Ana Ad",
    alt.kullanici_turu_adi AS "Çeviri",
    alt.dil_adi AS "Dil"
FROM kullanici_turleri AS alt
LEFT JOIN kullanici_turleri AS ust
    ON alt.ust_kullanici_turu_id = ust.kullanici_turu_id
ORDER BY "Türkçe Ana Ad", alt.dil_adi;

------------------------------------------------ */


/* seviyeler tablosuna veri ekle */

-- turkce verileri ekle
INSERT INTO seviyeler (ust_seviye_id, seviye_adi, dil_adi) VALUES
(NULL, 'Seviye 1', 'Türkçe'),
(NULL, 'Seviye 2', 'Türkçe'),
(NULL, 'Seviye 3', 'Türkçe'),
(NULL, 'Seviye 4', 'Türkçe'),
(NULL, 'Seviye 5', 'Türkçe'),
(NULL, 'Seviye 6', 'Türkçe'),
(NULL, 'Seviye 7', 'Türkçe'),
(NULL, 'Seviye 8', 'Türkçe'),
(NULL, 'Seviye 9', 'Türkçe'),
(NULL, 'Seviye 10', 'Türkçe');

-- loop ile cevirileri ekleme

-- loop ile veri ekleme

DO $$
DECLARE
    i INT;
    tr_adi TEXT;
    tr_id INT;
BEGIN
    FOR i IN 1..10 LOOP
        -- 1. Türkçe kaydın ID'sini al
        SELECT seviye_id INTO tr_id
        FROM seviyeler
        WHERE seviye_adi = 'Seviye ' || i AND dil_adi = 'Türkçe';

        -- 2. İngilizce, İspanyolca, Arapça çevirileri ekle
        INSERT INTO seviyeler (ust_seviye_id, seviye_adi, dil_adi)
        VALUES
            (tr_id, 'Level ' || i, 'English'),
            (tr_id, 'Nivel ' || i, 'Español'),
            (tr_id, 'المستوى ' || i, 'Arabic');
    END LOOP;
END $$;

/* ------------------------------------------------
-- join seviyeler tablosu ceviriler ile
SELECT
    CASE
        WHEN ust.seviye_adi IS NOT NULL THEN ust.seviye_adi
        ELSE alt.seviye_adi
    END AS "Türkçe Ana Ad",
    alt.seviye_adi AS "Çeviri",
    alt.dil_adi AS "Dil"
FROM seviyeler AS alt
LEFT JOIN seviyeler AS ust
    ON alt.ust_seviye_id = ust.seviye_id
ORDER BY "Türkçe Ana Ad", alt.dil_adi;

------------------------------------------------ */


/* modeller tablosuna veri ekle */

-- turkce verileri ekle
INSERT INTO modeller (
    ust_model_id, model_turu_id, model_resmi_adi, model_alias_adi, model_aciklama,
    kullanici_kapsami, aktif, devreye_alma_tarihi, devreden_kaldirilma_tarihi, dil_adi
) VALUES
(NULL, 2, 'EMRAM', 'EMRAM TR GENEL', 'Elektronik Sağlık Kaydı Modeli', 'Tek', 1, '2022-01-01', NULL, 'Türkçe'),

(NULL, 2, 'O-EMRAM', 'O-EMRAM TR I+T', 'Ayaktan Tedavi EMRAM', 'Tek', 1, '2022-06-15', NULL, 'Türkçe'),

(NULL, 2, 'CCMM', 'CCMM TR TEK', 'Süreklilik Olgunluk Modeli', 'Tek', 1, '2023-01-10', NULL, 'Türkçe'),

(NULL, 2, 'AMAM', 'AMAM TR GENEL', 'Analitik Olgunluk Modeli', 'Coklu', 1, '2023-05-01', NULL, 'Türkçe'),

(NULL, 1, 'SKS', 'SKS TR GENEL', 'Sağlıkta Kalite Standartları', 'Tek', 1, '2021-11-01', NULL, 'Türkçe'),

(NULL, 1, 'SAS', 'SAS TR TASLAK', 'Sağlıkta Akreditasyon Setleri', 'Coklu', 0, '2021-12-01', NULL, 'Türkçe'),

(NULL, 1, 'InnoPerf', 'InnoPerf TR V.1', 'Performans ve Yenilikçilik Modeli', 'Coklu', 2, '2024-01-01', '2025-01-01', 'Türkçe');


-- oto script ile veri ekleme

DO $$
DECLARE
    rec RECORD;
BEGIN
    FOR rec IN
        SELECT * FROM modeller
        WHERE model_resmi_adi IN ('EMRAM', 'O-EMRAM', 'CCMM', 'AMAM', 'InnoPerf')
          AND dil_adi = 'Türkçe'
    LOOP
        IF rec.model_resmi_adi = 'EMRAM' THEN
            INSERT INTO modeller (
                ust_model_id, model_turu_id, model_resmi_adi, model_alias_adi,
                model_aciklama, kullanici_kapsami, aktif,
                devreye_alma_tarihi, devreden_kaldirilma_tarihi, dil_adi
            ) VALUES
                (rec.model_id, rec.model_turu_id, 'EMRAM', 'EMRAM EN GENEL', 'Electronic Medical Record Adoption Model', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'English'),
                (rec.model_id, rec.model_turu_id, 'EMRAM', 'EMRAM ES GENEL', 'Modelo de Adopción de Registros Médicos Electrónicos', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Español'),
                (rec.model_id, rec.model_turu_id, 'EMRAM', 'EMRAM AR GENEL', 'نموذج تبني السجل الطبي الإلكتروني', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Arabic');

        ELSIF rec.model_resmi_adi = 'O-EMRAM' THEN
            INSERT INTO modeller (
                ust_model_id, model_turu_id, model_resmi_adi, model_alias_adi,
                model_aciklama, kullanici_kapsami, aktif,
                devreye_alma_tarihi, devreden_kaldirilma_tarihi, dil_adi
            ) VALUES
                (rec.model_id, rec.model_turu_id, 'O-EMRAM', 'O-EMRAM EN I+T', 'Outpatient EMRAM', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'English'),
                (rec.model_id, rec.model_turu_id, 'O-EMRAM', 'O-EMRAM ES I+T', 'EMRAM para atención ambulatoria', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Español'),
                (rec.model_id, rec.model_turu_id, 'O-EMRAM', 'O-EMRAM AR I+T', 'إي إم رام للعيادات الخارجية', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Arabic');

        ELSIF rec.model_resmi_adi = 'CCMM' THEN
            INSERT INTO modeller (
                ust_model_id, model_turu_id, model_resmi_adi, model_alias_adi,
                model_aciklama, kullanici_kapsami, aktif,
                devreye_alma_tarihi, devreden_kaldirilma_tarihi, dil_adi
            ) VALUES
                (rec.model_id, rec.model_turu_id, 'CCMM', 'CCMM EN T', 'Continuity Care Maturity Model', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'English'),
                (rec.model_id, rec.model_turu_id, 'CCMM', 'CCMM ES T', 'Modelo de Madurez para la Continuidad del Cuidado', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Español'),
                (rec.model_id, rec.model_turu_id, 'CCMM', 'CCMM AR T', 'نموذج نضج رعاية الاستمرارية', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Arabic');

        ELSIF rec.model_resmi_adi = 'AMAM' THEN
            INSERT INTO modeller (
                ust_model_id, model_turu_id, model_resmi_adi, model_alias_adi,
                model_aciklama, kullanici_kapsami, aktif,
                devreye_alma_tarihi, devreden_kaldirilma_tarihi, dil_adi
            ) VALUES
                (rec.model_id, rec.model_turu_id, 'AMAM', 'AMAM EN GENEL', 'Analytics Maturity Assessment Model', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'English'),
                (rec.model_id, rec.model_turu_id, 'AMAM', 'AMAM ES GENEL', 'Modelo de Evaluación de Madurez Analítica', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Español'),
                (rec.model_id, rec.model_turu_id, 'AMAM', 'AMAM AR GENEL', 'نموذج تقييم نضج التحليلات', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Arabic');

        ELSIF rec.model_resmi_adi = 'InnoPerf' THEN
            INSERT INTO modeller (
                ust_model_id, model_turu_id, model_resmi_adi, model_alias_adi,
                model_aciklama, kullanici_kapsami, aktif,
                devreye_alma_tarihi, devreden_kaldirilma_tarihi, dil_adi
            ) VALUES
                (rec.model_id, rec.model_turu_id, 'InnoPerf', 'InnoPerf EN V.1', 'Innovation & Performance Maturity Model', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'English'),
                (rec.model_id, rec.model_turu_id, 'InnoPerf', 'InnoPerf ES V.1', 'Modelo de Madurez en Rendimiento e Innovación', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Español'),
                (rec.model_id, rec.model_turu_id, 'InnoPerf', 'InnoPerf AR V.1', 'نموذج النضج في الأداء والابتكار', rec.kullanici_kapsami, rec.aktif, rec.devreye_alma_tarihi, rec.devreden_kaldirilma_tarihi, 'Arabic');
        END IF;
    END LOOP;
END $$;

/* ------------------------------------------------
-- modeller join

SELECT 
	m.model_resmi_adi AS "Model Adı",
    m.model_alias_adi AS "Model Kısa Adı",
    m.model_aciklama AS "Açıklama",
    m.dil_adi AS "Dil",
    
    CASE m.aktif
        WHEN 1 THEN 'Yayında'
        WHEN 0 THEN 'Taslak'
        WHEN 2 THEN 'Devre Dışı'
        ELSE 'Bilinmiyor'
    END AS "Durum",

    CASE 
        WHEN m.aktif = 2 THEN TO_CHAR(m.devreden_kaldirilma_tarihi, 'DD.MM.YYYY')
        ELSE TO_CHAR(m.devreye_alma_tarihi, 'DD.MM.YYYY')
    END AS "Tarih"

FROM modeller AS m
ORDER BY "Model Adı", "Dil";

------------------------------------------------ */

/* model_ulke tablosuna test verileri ekle */

-- ingilizce modelleri ekle
INSERT INTO model_ulke (ulke_id, model_id, devreye_alma_tarihi, dil_adi, aktif)
SELECT  u.ulke_id,
        m.model_id,
        COALESCE(m.devreye_alma_tarihi, CURRENT_DATE),
        'English',
        TRUE                                -- İngilizce global atama hep aktif
FROM    ulkeler         u                  -- tüm ülkeler
JOIN    modeller        m  ON m.dil_adi = 'English'
WHERE   m.aktif = 1                         -- sadece Yayında olanlar
ON CONFLICT DO NOTHING;                     -- tekrar çalıştırıldığında çakışma yok


-- ülke dil tablosu ile model_ulke tablosunu birleştir
WITH dil_map AS (
    SELECT dil_id, dil_adi FROM diller
)
INSERT INTO model_ulke (ulke_id, model_id, devreye_alma_tarihi, dil_adi, aktif)
SELECT  ud.ulke_id,
        m.model_id,
        COALESCE(m.devreye_alma_tarihi, CURRENT_DATE),
        m.dil_adi,
        (m.aktif = 1)               -- Yayında → TRUE, Devre Dışı/Taslak → FALSE
FROM    modeller      m
JOIN    dil_map       d   ON d.dil_adi = m.dil_adi
JOIN    ulke_dil      ud  ON ud.dil_id  = d.dil_id
WHERE   m.dil_adi <> 'English'       -- İngilizceler zaten eklendi
ON CONFLICT DO NOTHING;

/* ------------------------------------------------
-- modeller ülkeler ve dilleri join
SELECT u.ulke_adi,
       m.model_resmi_adi,
       m.dil_adi,
       mu.aktif
FROM   model_ulke mu
JOIN   ulkeler   u ON u.ulke_id  = mu.ulke_id
JOIN   modeller  m ON m.model_id = mu.model_id
ORDER  BY u.ulke_adi, m.model_resmi_adi, m.dil_adi;
------------------------------------------------ */


/* model seviye tablosuna veri ekleme */

INSERT INTO model_seviye (model_id, seviye_id)
SELECT m.model_id,
       s.seviye_id
FROM   modeller      m
JOIN   model_turleri t ON t.model_turu_id = m.model_turu_id
JOIN   seviyeler     s ON s.dil_adi      = m.dil_adi
WHERE  t.model_turu_adi = 'Seviye Esaslı'               -- sadece level-based
  AND (  s.ust_seviye_id IS NOT NULL                    -- çeviri satırları
      OR (s.ust_seviye_id IS NULL AND m.dil_adi = 'Türkçe') )  -- kök TR
ON CONFLICT DO NOTHING;


/* ------------------------------------------------

-- model seviye join

SELECT
    m.model_resmi_adi,
    m.dil_adi,
    s.seviye_adi,
    u.ulke_adi,
CASE WHEN mu.aktif THEN 'Yayında' ELSE 'Taslak' END AS Durum
          -- son satırda VİRGÜL YOK
FROM   model_seviye ms
JOIN   modeller    m ON m.model_id  = ms.model_id
JOIN   seviyeler   s ON s.seviye_id = ms.seviye_id
JOIN   model_ulke  mu ON mu.model_id = m.model_id
JOIN   ulkeler     u ON u.ulke_id   = mu.ulke_id
ORDER  BY m.model_resmi_adi, m.dil_adi, s.seviye_id;

SELECT m.model_resmi_adi,
       t.model_turu_adi,
       count(*) AS seviye_sayisi
FROM   model_seviye ms
JOIN   modeller      m ON m.model_id   = ms.model_id
JOIN   model_turleri t ON t.model_turu_id = m.model_turu_id
GROUP  BY m.model_resmi_adi, t.model_turu_adi
ORDER  BY m.model_resmi_adi;

------------------------------------------------ */

/*  model hastane turu veri ekleme */

INSERT INTO model_hastane_turu (model_id, hastane_turu_id)
SELECT  m.model_id,
        pick.root_id
FROM   modeller m
JOIN   LATERAL (
        SELECT DISTINCT ON (COALESCE(ht.ust_hastane_turu_id, ht.hastane_turu_id))
               COALESCE(ht.ust_hastane_turu_id, ht.hastane_turu_id) AS root_id
        FROM   hastane_turleri ht
        WHERE  ht.dil_adi = m.dil_adi
        ORDER  BY COALESCE(ht.ust_hastane_turu_id, ht.hastane_turu_id), random()
        LIMIT  2
      ) AS pick ON TRUE
ON CONFLICT DO NOTHING;

/* ------------------------------------------------
			join model hastane turu

-- Modelin diline karşılık gelen hastane türü çevirisini bulur.
SELECT
    m.model_resmi_adi,                                                  -- Modelin resmi adı
    m.dil_adi,                                                          -- Modelin dili
    COALESCE(ht_lang.hastane_turu_adi, ht_root.hastane_turu_adi) AS hastane_turu_adi, -- Sihir burada: Önce çevrilmiş adı (`ht_lang`) al, eğer boşsa (NULL) ana adı (`ht_root`) al.
    u.ulke_adi                                                          -- Modelin bulunduğu ülke

FROM    model_hastane_turu mh                                           -- Model-Hastane Türü eşleşme tablosundan başla
JOIN    modeller m ON m.model_id = mh.model_id                          -- Model detaylarını (`dil_adi` önemli) almak için `modeller`i bağla
JOIN    hastane_turleri ht_root ON ht_root.hastane_turu_id = mh.hastane_turu_id -- Eşleşmedeki ID'yi kullanarak hastane türünün ana kaydını (`ht_root`) bul
LEFT    JOIN hastane_turleri ht_lang                                    -- Şimdi aynı tabloyu çeviriyi (`ht_lang`) bulmak için TEKRAR bağla (LEFT JOIN ile)
        ON ht_lang.ust_hastane_turu_id = ht_root.hastane_turu_id         -- Şart 1: Çeviri, ana kayda bağlı olmalı
       AND ht_lang.dil_adi = m.dil_adi                                  -- Şart 2: Çevirinin dili, modelin diliyle aynı olmalı
JOIN    model_ulke mu ON mu.model_id = m.model_id                       -- Ülke ID'sini bulmak için `model_ulke`yi bağla
JOIN    ulkeler u ON u.ulke_id = mu.ulke_id                             -- Ülke adını almak için `ulkeler`i bağla
ORDER BY m.model_resmi_adi, m.dil_adi;                                   -- Sonuçları model adı ve diline göre sırala


-- Belirli bir modele (`AMAM`) ve dile (`Arabic`) göre ilişkili hastane türü çevirilerini getir.
   Çeviri yoksa fallback root kullanılır.

SELECT
    m.model_resmi_adi,
    m.dil_adi,
    COALESCE(ht_lang.hastane_turu_adi, ht_root.hastane_turu_adi) AS hastane_turu_adi,
    u.ulke_adi
FROM   model_hastane_turu mh
JOIN   modeller m ON m.model_id = mh.model_id
JOIN   hastane_turleri ht_root ON ht_root.hastane_turu_id = mh.hastane_turu_id
LEFT   JOIN hastane_turleri ht_lang 
       ON ht_lang.ust_hastane_turu_id = ht_root.hastane_turu_id
      AND ht_lang.dil_adi = m.dil_adi
JOIN   model_ulke mu ON mu.model_id = m.model_id
JOIN   ulkeler u ON u.ulke_id = mu.ulke_id
WHERE  m.model_resmi_adi = 'AMAM'
  AND  m.dil_adi = 'Arabic'
ORDER  BY hastane_turu_adi;


-- Hangi root hastane türünün hangi dillerde çevirisi olduğunu göster.
   Veri kalitesini denetlemek için kullanılır.

SELECT 
    ht_root.hastane_turu_id AS root_id,
    ht_root.hastane_turu_adi AS default_adi,
    ht_lang.dil_adi,
    ht_lang.hastane_turu_adi AS ceviri
FROM   hastane_turleri ht_root
LEFT   JOIN hastane_turleri ht_lang ON ht_lang.ust_hastane_turu_id = ht_root.hastane_turu_id
WHERE  ht_root.ust_hastane_turu_id IS NULL
ORDER BY ht_root.hastane_turu_id, ht_lang.dil_adi;

------------------------------------------------ */



-- model kullanici kapsami veri ekleme

-- `map` adında geçici bir sanal tablo oluşturur.
-- Hangi modelin hangi kullanıcı türüyle ilişkilendirileceğini burada hard-coded olarak belirtiriz.
WITH map(model_key, user_key) AS (
    VALUES
      ('EMRAM'   , 'Genel'),
      ('O-EMRAM' , 'İdari Personel'),
      ('O-EMRAM' , 'Tıbbi Personel'),
      ('CCMM'    , 'Tıbbi Personel'),
      ('AMAM'    , 'Genel'),
      ('SKS'     , 'Genel'),
      ('SAS'     , 'Genel'),
      ('InnoPerf', 'İdari Personel')
)
-- Yukarıdaki `map`'i kullanarak model ve kullanıcı türü ilişkilerini `model_kullanici_kapsami` tablosuna ekler.
INSERT INTO model_kullanici_kapsami (model_id, kullanici_turu_id)
SELECT  m.model_id,
        kt.kullanici_turu_id     -- Eklenecek olan, kullanici_turu'nün ana (kök) ID'sidir.
FROM   modeller m
JOIN   map        mp ON mp.model_key = m.model_resmi_adi -- `map` ile modelleri, model adına göre birleştirir.
JOIN   kullanici_turleri kt
       ON  kt.kullanici_turu_adi       = mp.user_key
       AND kt.ust_kullanici_turu_id IS NULL             -- Sadece ana (kök) kayıtları bulur, çevirileri göz ardı eder.
ON CONFLICT DO NOTHING;                                 -- Eğer bu ilişki zaten varsa, hata verme, işlemi atla.
/*----------------------------------------------------------------*/


/*
/* ==========================================
   MODELLER × KULLANICI TÜRLERİ (UI dilinde)
   ==========================================*/
-- Kullanıcı türü adını SADECE 'Türkçe' olarak getirmeye çalışan sorgu.
SELECT m.model_resmi_adi           AS model,
       m.dil_adi                   AS model_dili,
       -- Önce Türkçe çeviriyi (`kt_lang`) arar, bulamazsa ana (`kt_root`) adı gösterir.
       COALESCE(kt_lang.kullanici_turu_adi,
                kt_root.kullanici_turu_adi)    AS kullanici_turu_adi
FROM   model_kullanici_kapsami mk
JOIN   modeller          m       ON m.model_id            = mk.model_id
JOIN   kullanici_turleri kt_root ON kt_root.kullanici_turu_id = mk.kullanici_turu_id -- İlişkideki ana (kök) kullanıcı türünü bulur.
-- FARK BURADA BAŞLIYOR:
LEFT   JOIN kullanici_turleri kt_lang
       ON  kt_lang.ust_kullanici_turu_id = kt_root.kullanici_turu_id
       AND kt_lang.dil_adi = 'Türkçe'   -- DİKKAT: Dil burada 'Türkçe' olarak sabitlenmiştir.
ORDER  BY model, kullanici_turu_adi;


-- UI Kullanıcı türü adını, modelin kendi diline göre dinamik olarak getirir.
SELECT m.model_resmi_adi        AS model,
       m.dil_adi                AS model_dili,
       -- Önce modelin dilindeki çeviriyi (`kt_lang`) arar, bulamazsa ana (`kt_root`) adı gösterir.
       COALESCE(kt_lang.kullanici_turu_adi,
                kt_root.kullanici_turu_adi)  AS kullanici_turu_adi,
       COALESCE(kt_lang.dil_adi, kt_root.dil_adi) AS tur_dili
FROM   model_kullanici_kapsami mk
JOIN   modeller                m       ON m.model_id = mk.model_id
JOIN   kullanici_turleri       kt_root ON kt_root.kullanici_turu_id = mk.kullanici_turu_id
-- FARK VE DOĞRU YÖNTEM BURADA:
LEFT   JOIN kullanici_turleri       kt_lang
       ON  kt_lang.ust_kullanici_turu_id = kt_root.kullanici_turu_id
       AND kt_lang.dil_adi = m.dil_adi  -- DİKKAT: Çevirinin dili, modelin diliyle (`m.dil_adi`) eşleşmeli.
ORDER  BY model, model_dili, kullanici_turu_adi;



-- TEŞHİS SORGUSU: Bir modelin ilişkili olduğu kullanıcı türünün ana adını ve TÜM çevirilerini listeler.
-- Bu sorgu, her çeviri için bir satır oluşturarak veriyi "çoğaltır".
SELECT m.model_resmi_adi           AS model,
       m.dil_adi                   AS model_dili,
       kt_root.kullanici_turu_adi    AS root_adi_tr,  -- Kullanıcı türünün ana (kök) adını gösterir.
       kt_lang.kullanici_turu_adi    AS ceviri_adi,   -- Bulunan çevirinin adını gösterir. Boş olabilir.
       COALESCE(kt_lang.dil_adi,'Türkçe') AS ceviri_dili -- Çevirinin dilini, çeviri yoksa 'Türkçe' olarak gösterir.
FROM   model_kullanici_kapsami mk
JOIN   modeller          m  ON m.model_id = mk.model_id
JOIN   kullanici_turleri kt_root
       ON kt_root.kullanici_turu_id = mk.kullanici_turu_id
-- FARK BURADA: Dil filtresi olmadan JOIN yapılır.
LEFT   JOIN kullanici_turleri kt_lang
       ON  kt_lang.ust_kullanici_turu_id = kt_root.kullanici_turu_id -- DİKKAT: Dil filtresi KASITLI olarak yoktur. Amaç, mevcut tüm çevirileri bulmaktır.
ORDER  BY model, ceviri_dili; -- Her bir modelin tüm çevirilerini gruplu görmek için sıralama yapılır.



/*
----------------------------------------------------------------------------------------------------
-- GENEL AÇIKLAMA (İDEAL SORGUDUR):
-- Bu sorgu, modellerin ilişkili olduğu kullanıcı türlerini listeler.
-- LEFT JOIN'e `AND kt_lang.dil_adi = m.dil_adi` koşulu eklenerek,
-- kullanıcı türü adının HER ZAMAN modelin kendi dilinde getirilmesi sağlanmıştır.
-- Eğer o dilde çeviri yoksa, COALESCE sayesinde ana (kök) isim gösterilir.
----------------------------------------------------------------------------------------------------
*/
SELECT m.model_resmi_adi        AS model,
       m.dil_adi                AS model_dili,
       -- Önce modelin dilindeki çeviriyi (`kt_lang`) arar, bulamazsa ana (`kt_root`) adı gösterir.
       COALESCE(kt_lang.kullanici_turu_adi,
                kt_root.kullanici_turu_adi)  AS kullanici_turu_adi,
       -- Üstteki mantığın aynısı, bu sefer türün dilini doğru göstermek için.
       COALESCE(kt_lang.dil_adi, kt_root.dil_adi) AS tur_dili
FROM   model_kullanici_kapsami mk
JOIN   modeller                m       ON m.model_id = mk.model_id
JOIN   kullanici_turleri       kt_root ON kt_root.kullanici_turu_id = mk.kullanici_turu_id -- İlişkideki ana (kök) kullanıcı türünü bulur.
-- FARK VE DOĞRU YÖNTEM BURADA:
LEFT   JOIN kullanici_turleri       kt_lang
       ON  kt_lang.ust_kullanici_turu_id = kt_root.kullanici_turu_id
       AND kt_lang.dil_adi = m.dil_adi  -- <<-- SİHİR BURADA: Çevirinin dili, modelin diliyle (`m.dil_adi`) eşleşmek zorunda.
ORDER  BY model, model_dili, kullanici_turu_adi;
*/


/* ============================================================
   BOYUT (Dimension) VERİLERİNİ ÇOK-DİLLİ VE HİYERARŞİK EKLEME
   ============================================================ */

-- 1) KÖK (TÜRKÇE) BOYUTLAR  -----------------------------------
WITH tr_roots AS (
  INSERT INTO boyutlar (
      ust_boyut_id, boyut_id_hiyerarsi, boyut_adi,
      boyut_allias, boyut_etiketleri, hiyerarsi, aktif, dil_adi
  )
  VALUES
    -- Ana kategoriler (hiyerarsi seviye = 1)
    (NULL, NULL, 'Dijital Sağlık Altyapısı' , 'Dijital SA',  'Altyapı',          1, 1, 'Türkçe'),
    (NULL, NULL, 'Hasta Deneyimi ve Katılımı', 'Hasta DK',   'Hasta, Katılım',   1, 1, 'Türkçe'),
    (NULL, NULL, 'Afet ve Güvenlik Hazırlığı', 'Afet GH',    'Afet, Güvenlik',   1, 1, 'Türkçe')
  ON CONFLICT DO NOTHING
  RETURNING boyut_id, boyut_adi,boyut_id_hiyerarsi 
),

tr_leafs AS (
  /* Ebeveyn ID’lerini aldığımız için alt boyutları rahatça ekleriz */
  INSERT INTO boyutlar (
      ust_boyut_id, boyut_id_hiyerarsi, boyut_adi,
      boyut_allias, boyut_etiketleri, hiyerarsi, aktif, dil_adi
  )
  SELECT
      NULL,                                    -- dil bağlamı için daha sonra kullanılacak
      parent.boyut_id,                         -- <<< boyut_id_hiyerarsi = üst kategori
      leaf.tr_adi,
      leaf.alias,
      leaf.etiket,
      2,                                       -- hiyerarşik seviye (sub)
      1,
      'Türkçe'
  FROM (VALUES
          ('1.1 Veri Yönetimi ve Paylaşımı'     , 'Data Capture' , 'Veri',       'Dijital Sağlık Altyapısı'),
          ('1.2 Sağlık Bilişimi Planlaması'     , 'Analytics'    , 'Analitik',   'Dijital Sağlık Altyapısı'),
          ('2.1 Hasta Katılımı'                 , 'Engagement'   , 'Hasta',      'Hasta Deneyimi ve Katılımı'),
          ('2.2 Klinik Kullanıcı Benimsemesi'   , 'Adoption'     , 'Klinik',     'Hasta Deneyimi ve Katılımı'),
          ('3.1 Felaket Kurtarma ve İş Sürekliliği','DRP'       , 'Felaket',     'Afet ve Güvenlik Hazırlığı'),
          ('3.2 Teknoloji Altyapısı'            , 'Tech Facility', 'Altyapı',    'Afet ve Güvenlik Hazırlığı'),
          ('3.3 Teknoloji Planları'             , 'Tech Plan'   , 'Planlama',    'Afet ve Güvenlik Hazırlığı')
       ) AS leaf(tr_adi, alias, etiket, parent_tr_adi)
  JOIN tr_roots parent
       ON parent.boyut_adi = leaf.parent_tr_adi
  ON CONFLICT DO NOTHING
  RETURNING boyut_id, boyut_adi, boyut_id_hiyerarsi
),

all_tr AS (   -- kök + yaprak -> dil çevirisine lazım
  SELECT boyut_id, boyut_adi, boyut_id_hiyerarsi FROM tr_roots
  UNION ALL
  SELECT boyut_id, boyut_adi, boyut_id_hiyerarsi FROM tr_leafs
),

-- 2) DİL ÇEVİRİLERİ  -------------------------------------------
ins_lang AS (
  /* Dil = İngilizce, İspanyolca, Arapça  */
  INSERT INTO boyutlar (
      ust_boyut_id, boyut_id_hiyerarsi, boyut_adi,
      boyut_allias, boyut_etiketleri, hiyerarsi, aktif, dil_adi
  )
  SELECT
      tr.boyut_id,                    -- <<< ust_boyut_id = TR satırı (dil bağı)
      tr.boyut_id_hiyerarsi,          -- hiyerarşi aynen miras
      cv.lang_adi,
      cv.alias,
      cv.etiket,
      CASE WHEN tr.boyut_id_hiyerarsi IS NULL THEN 1 ELSE 2 END,
      1,
      cv.dil
  FROM all_tr tr
  JOIN LATERAL (
      /* Çeviri sözlüğü (TR ↔ EN/ES/AR) --------------------------
         boyut_adi_tr, dil, lang_adi, alias, etiket
         --------------------------------------------------------*/
      VALUES
        -- --------------- Dijital Sağlık Altyapısı --------------
        ('Dijital Sağlık Altyapısı', 'English', 'Digital Health Infrastructure' , 'Digital HI', 'Infrastructure'),
        ('Dijital Sağlık Altyapısı', 'Español', 'Infraestructura de Salud Digital', 'Salud Digital', 'Infraestructura'),
        ('Dijital Sağlık Altyapısı', 'Arabic' , 'البنية التحتية للصحة الرقمية',    'الصحة الرقمية', 'بنية تحتية'),

        ('1.1 Veri Yönetimi ve Paylaşımı', 'English', 'Data Capture & Health Information Exchange', 'Data Capture', 'Data'),
        ('1.1 Veri Yönetimi ve Paylaşımı', 'Español', 'Captura de Datos e Intercambio de Información Sanitaria', 'Captura de Datos', 'Datos'),
        ('1.1 Veri Yönetimi ve Paylaşımı', 'Arabic' , 'اكتساب البيانات وتبادل المعلومات الصحية', 'اكتساب البيانات', 'بيانات'),

        ('1.2 Sağlık Bilişimi Planlaması', 'English', 'Healthcare Analytics & Outcomes Measurement', 'Analytics', 'Analytics'),
        ('1.2 Sağlık Bilişimi Planlaması', 'Español', 'Analítica de Salud y Medición de Resultados', 'Analítica', 'Analítica'),
        ('1.2 Sağlık Bilişimi Planlaması', 'Arabic' , 'تحليلات الرعاية الصحية وقياس النتائج', 'تحليلات', 'تحليلات'),

        -- --------------- Hasta Deneyimi ve Katılımı ------------
        ('Hasta Deneyimi ve Katılımı', 'English', 'Patient Experience & Engagement', 'Patient EE', 'Patient'),
        ('Hasta Deneyimi ve Katılımı', 'Español', 'Experiencia y Participación del Paciente', 'Paciente PE', 'Paciente'),
        ('Hasta Deneyimi ve Katılımı', 'Arabic' , 'تجربة المريض ومشاركته',          'المريض', 'مريض'),

        ('2.1 Hasta Katılımı', 'English', 'Patient Engagement',  'Engagement',  'Patient'),
        ('2.1 Hasta Katılımı', 'Español', 'Participación del Paciente', 'Participación', 'Paciente'),
        ('2.1 Hasta Katılımı', 'Arabic' , 'مشاركة المريض',       'المريض', 'مريض'),

        ('2.2 Klinik Kullanıcı Benimsemesi', 'English', 'Clinical User Adoption', 'User Adoption', 'Clinical'),
        ('2.2 Klinik Kullanıcı Benimsemesi', 'Español', 'Adopción de Usuarios Clínicos', 'Adopción', 'Clínico'),
        ('2.2 Klinik Kullanıcı Benimsemesi', 'Arabic' , 'تبني المستخدمين الإكلينيكيين', 'تبني', 'إكلينيكي'),

        -- --------------- Afet ve Güvenlik Hazırlığı ------------
        ('Afet ve Güvenlik Hazırlığı', 'English', 'Disaster & Safety Readiness', 'Disaster SR', 'Safety'),
        ('Afet ve Güvenlik Hazırlığı', 'Español', 'Preparación ante Desastres y Seguridad', 'Desastre', 'Seguridad'),
        ('Afet ve Güvenlik Hazırlığı', 'Arabic' , 'الاستعداد للكوارث والسلامة',    'الكوارث', 'سلامة'),

        ('3.1 Felaket Kurtarma ve İş Sürekliliği', 'English', 'Disaster Recovery & Business Continuity', 'DR/BC', 'Disaster'),
        ('3.1 Felaket Kurtarma ve İş Sürekliliği', 'Español', 'Recuperación ante Desastres y Continuidad del Negocio', 'Recuperación', 'Desastre'),
        ('3.1 Felaket Kurtarma ve İş Sürekliliği', 'Arabic' , 'استعادة البيانات بعد الكوارث واستمرار الأعمال', 'استعادة', 'كوارث'),

        ('3.2 Teknoloji Altyapısı', 'English', 'Technology Facilities', 'Tech Facility', 'Technology'),
        ('3.2 Teknoloji Altyapısı', 'Español', 'Instalaciones Tecnológicas', 'Instalaciones', 'Tecnología'),
        ('3.2 Teknoloji Altyapısı', 'Arabic' , 'مرافق التكنولوجيا',          'مرافق التكنولوجيا', 'تكنولوجيا'),

        ('3.3 Teknoloji Planları', 'English', 'Technology Planning', 'Tech Planning', 'Planning'),
        ('3.3 Teknoloji Planları', 'Español', 'Planificación Tecnológica', 'Planificación', 'Planificación'),
        ('3.3 Teknoloji Planları', 'Arabic' , 'تخطيط التكنولوجيا',           'تخطيط التكنولوجيا', 'تخطيط')
      ) AS cv(tr_adi, dil, lang_adi, alias, etiket)
      ON cv.tr_adi = tr.boyut_adi      -- hangi TR satırın çevirisi?
  ON CONFLICT DO NOTHING
)
SELECT 'Boyutlar eklendi';

/*
/* 3) RAPOR: Ağaç yapıyı kontrol için ---------------------------*/
SELECT b_tr.boyut_adi      AS turkce_kök,
       b_tr.boyut_id       AS tr_id,
       b_tr.hiyerarsi      AS seviye,
       b_en.boyut_adi      AS en_adi
FROM   boyutlar b_tr
LEFT   JOIN boyutlar b_en
       ON b_en.ust_boyut_id = b_tr.boyut_id
       AND b_en.dil_adi = 'English'
WHERE  b_tr.dil_adi = 'Türkçe'
ORDER  BY b_tr.hiyerarsi, b_tr.boyut_adi;
*/



/* ============================================================
   ÇOK DİLLİ KRİTER EKLEME BETİĞİ
   ============================================================ */

/* ------------------------------------------------------------
   1) TÜRKÇE KÖK KRİTERLER
   ------------------------------------------------------------ */
WITH tr_criteria AS (
  INSERT INTO kriterler (
      ust_kriter_id, kriter_adi, kriter_alias,
      kriter_etiketleri, dil_adi, aktif
  )
  VALUES
    (NULL, 'Klinik kullanıcıların %95''inden fazlası elektronik hasta kaydını aktif şekilde kullanmaktadır.',
           'KR01', 'kullanım, EHR, oran', 'Türkçe', 1),
    (NULL, 'Tüm ilaç uygulamaları barkod ile doğrulama sistemi üzerinden yapılmaktadır.',
           'KR02', 'ilaç, barkod, doğrulama', 'Türkçe', 1),
    (NULL, 'Hemşireler ilaç vermeden önce hastanın kimliğini barkod ile doğrulamaktadır.',
           'KR03', 'hemşire, barkod, kimlik', 'Türkçe', 1),
    (NULL, 'Klinik notların %90’ı yapılandırılmış alanlara girilmektedir.',
           'KR04', 'not, yapılandırılmış, yüzde', 'Türkçe', 1),
    (NULL, 'Doktorlar, order-entry sistemini kullanarak ilaçları doğrudan reçetelendirmektedir.',
           'KR05', 'doktor, order-entry, reçete', 'Türkçe', 1),
    (NULL, 'Hatalı hasta-ilaç eşleşmelerini önlemek için “time-out” kontrol listeleri kullanılmaktadır.',
           'KR06', 'hata, ilaç, time-out', 'Türkçe', 1),
    (NULL, 'Klinik personelin %90''ından fazlası elektronik dokümantasyonu tamamlamaktadır.',
           'KR07', 'dökümantasyon, elektronik, personel', 'Türkçe', 1),
    (NULL, 'Hasta kimlik bileklikleri hasta kabul sırasında sistemden otomatik basılmaktadır.',
           'KR08', 'bileklik, otomatik, kabul', 'Türkçe', 1),
    (NULL, 'Klinik kullanıcılar sisteme günlük ortalama 5''ten fazla giriş yapmaktadır.',
           'KR09', 'günlük giriş, kullanıcı, sıklık', 'Türkçe', 1),
    (NULL, 'Her hastaya özel klinik izlem planı dijital ortamda kaydedilmektedir.',
           'KR10', 'izlem planı, dijital, hasta', 'Türkçe', 1),
    (NULL, 'Doktorlar tedavi planlarını doğrudan sistem üzerinden oluşturmakta ve izlemektedir.',
           'KR11', 'tedavi planı, doktor, sistem', 'Türkçe', 1),
    (NULL, 'Kullanıcılar elektronik sistemler üzerinde uyarı/hatırlatma bildirimlerini dikkate almaktadır.',
           'KR12', 'uyarı, hatırlatma, sistem', 'Türkçe', 1),
    (NULL, 'Klinik karar destek sistemi, ilaç etkileşimlerini otomatik olarak bildirmektedir.',
           'KR13', 'karar destek, ilaç, etkileşim', 'Türkçe', 1),
    (NULL, 'Tüm görüntüleme sonuçları sistem üzerinden klinik kullanıcıya anlık sunulmaktadır.',
           'KR14', 'görüntüleme, anlık, sonuç', 'Türkçe', 1),
    (NULL, 'Yatan hasta birimleri günlük vizit notlarını tamamen dijital olarak kaydetmektedir.',
           'KR15', 'vizit, dijital, yatan hasta', 'Türkçe', 1),
    (NULL, 'Hemşire gözlemleri belirlenmiş veri alanlarına göre elektronik kaydedilmektedir.',
           'KR16', 'hemşire, gözlem, elektronik', 'Türkçe', 1),
    (NULL, 'Sistem üzerinde tanımlı roller doğrultusunda sadece yetkili kişiler veri girişine sahiptir.',
           'KR17', 'rol, yetki, veri girişi', 'Türkçe', 1),
    (NULL, 'Laboratuvar sonuçları, order sistemine entegre şekilde doğrudan hastaya atanır.',
           'KR18', 'laboratuvar, entegrasyon, order', 'Türkçe', 1),
    (NULL, 'Klinisyenler arasında konsültasyon talepleri sistem üzerinden yapılmaktadır.',
           'KR19', 'konsültasyon, talep, klinisyen', 'Türkçe', 1),
    (NULL, 'Klinik eğitim programları, sistem kullanımına dair modülleri de içermektedir.',
           'KR20', 'eğitim, modül, sistem', 'Türkçe', 1),
    (NULL, 'Kullanıcılar klinik sistem hatalarını bildirmek için elektronik bildirim modülünü kullanmaktadır.',
           'KR21', 'hata, bildirim, kullanıcı', 'Türkçe', 1),
    (NULL, 'Klinik sistem performansı düzenli olarak kullanıcı anketleri ile izlenmektedir.',
           'KR22', 'performans, anket, sistem', 'Türkçe', 1),
    (NULL, 'Elektronik order sisteminde ilaç doz hataları için uyarı algoritmaları mevcuttur.',
           'KR23', 'order, doz, uyarı', 'Türkçe', 1),
    (NULL, 'Mobil cihazlar üzerinden klinik bilgi girişi yapılabilmektedir.',
           'KR24', 'mobil, bilgi girişi, cihaz', 'Türkçe', 1),
    (NULL, 'Klinik kullanıcılar sisteme 2 adımlı kimlik doğrulama ile giriş yapmaktadır.',
           'KR25', '2FA, kimlik, giriş', 'Türkçe', 1),
    (NULL, 'Hasta çıkış epikrizleri sistem üzerinden yapılandırılmış şekilde doldurulmaktadır.',
           'KR26', 'epikriz, çıkış, yapılandırılmış', 'Türkçe', 1),
    (NULL, 'Yoğun bakım veri seti sistemde yapılandırılmış olarak tutulmaktadır.',
           'KR27', 'yoğun bakım, veri seti, yapılandırılmış', 'Türkçe', 1),
    (NULL, 'Hemşireler vital bulguları mobil cihazlar üzerinden doğrudan sisteme girer.',
           'KR28', 'vital, mobil, hemşire', 'Türkçe', 1),
    (NULL, 'Hasta takibi için klinik skorlamalar otomatik olarak hesaplanmaktadır.',
           'KR29', 'skorlama, otomatik, takip', 'Türkçe', 1),
    (NULL, 'Sistem, medikal cihazlardan gelen verileri hasta dosyasına otomatik işler.',
           'KR30', 'cihaz entegrasyonu, otomatik, veri', 'Türkçe', 1)
  ON CONFLICT DO NOTHING
  RETURNING kriter_id, kriter_alias, kriter_adi, kriter_etiketleri
),

/* ------------------------------------------------------------
   2) İNG-ES-AR ÇEVİRİLERİ
   ------------------------------------------------------------ */
ins_lang AS (
  INSERT INTO kriterler (
      ust_kriter_id, kriter_adi, kriter_alias,
      kriter_etiketleri, dil_adi, aktif
  )
  SELECT
      tr.kriter_id,                     -- >>> dil bağı
      cv.lang_adi,                      -- kriter_adi
      tr.kriter_alias,                  -- alias aynı
      tr.kriter_etiketleri,             -- etiketler TR’den kopya (opsiyonel)
      cv.dil,                           -- dil_adi
      1
  FROM tr_criteria tr
  JOIN LATERAL (
      /* --------------- ÇEVİRİ SÖZLÜĞÜ -------------------------
         alias, dil, çeviri
         (yalnızca KR01…KR05 örnek, devamını aynı kalıpla ekleyebilirsin)
         -------------------------------------------------------*/
      VALUES
-- KR01
      ('KR01','English','More than 95% of clinical users actively use the EHR.'),
      ('KR01','Español','Más del 95 % de los usuarios clínicos utilizan activamente la HCE.'),
      ('KR01','Arabic' ,'أكثر من ‎95‎٪ من المستخدمين السريريين يستخدمون سجل المريض الإلكتروني بنشاط.'),
      -- KR02
      ('KR02','English','All medication administrations are verified via barcode.'),
      ('KR02','Español','Todas las administraciones de medicamentos se verifican mediante código de barras.'),
      ('KR02','Arabic' ,'يتم التحقق من جميع إعطاءات الأدوية باستخدام نظام الباركود.'),
      -- KR03
      ('KR03','English','Nurses verify patient identity with barcode before medication.'),
      ('KR03','Español','Las enfermeras verifican la identidad del paciente con código de barras antes de administrar medicamentos.'),
      ('KR03','Arabic' ,'تتحقق الممرضات من هوية المريض بالباركود قبل إعطاء الدواء.'),
      -- KR04
      ('KR04','English','90% of clinical notes are entered into structured fields.'),
      ('KR04','Español','El 90 % de las notas clínicas se ingresan en campos estructurados.'),
      ('KR04','Arabic' ,'يتم إدخال ‎90‎٪ من الملاحظات السريرية في حقول مُهيكلة.'),
      -- KR05
      ('KR05','English','Physicians e-prescribe directly via order-entry.'),
      ('KR05','Español','Los médicos prescriben directamente a través del sistema de órdenes.'),
      ('KR05','Arabic' ,'يصف الأطباء الأدوية مباشرة عبر نظام إدخال الأوامر.'),
      -- KR06
      ('KR06','English','"Time-out" checklists are used to prevent incorrect patient-medication pairings.'),
      ('KR06','Español','Se utilizan listas de verificación de "tiempo muerto" para evitar emparejamientos incorrectos de paciente-medicamento.'),
      ('KR06','Arabic' ,'تُستخدم قوائم التحقق "الوقت المستقطع" لمنع الاقتران الخاطئ بين المريض والدواء.'),
      -- KR07
      ('KR07','English','More than 90% of clinical staff complete electronic documentation.'),
      ('KR07','Español','Más del 90 % del personal clínico completa la documentación electrónica.'),
      ('KR07','Arabic' ,'أكثر من 90٪ من الموظفين السريريين يكملون التوثيق الإلكتروني.'),
      -- KR08
      ('KR08','English','Patient identification wristbands are automatically printed from the system upon admission.'),
      ('KR08','Español','Las pulseras de identificación del paciente se imprimen automáticamente desde el sistema al momento del ingreso.'),
      ('KR08','Arabic' ,'تتم طباعة أساور تعريف المريض تلقائيًا من النظام عند القبول.'),
      -- KR09
      ('KR09','English','Clinical users log into the system more than 5 times on average daily.'),
      ('KR09','Español','Los usuarios clínicos inician sesión en el sistema más de 5 veces en promedio al día.'),
      ('KR09','Arabic' ,'يقوم المستخدمون السريريون بتسجيل الدخول إلى النظام أكثر من 5 مرات في المتوسط يوميًا.'),
      -- KR10
      ('KR10','English','A specific clinical monitoring plan for each patient is recorded digitally.'),
      ('KR10','Español','Se registra digitalmente un plan de seguimiento clínico específico para cada paciente.'),
      ('KR10','Arabic' ,'يتم تسجيل خطة متابعة سريرية خاصة بكل مريض رقميًا.'),
      -- KR11
      ('KR11','English','Physicians create and monitor treatment plans directly through the system.'),
      ('KR11','Español','Los médicos crean y supervisan los planes de tratamiento directamente a través del sistema.'),
      ('KR11','Arabic' ,'يقوم الأطباء بإنشاء ومراقبة خطط العلاج مباشرة عبر النظام.'),
      -- KR12
      ('KR12','English','Users pay attention to alert/reminder notifications on electronic systems.'),
      ('KR12','Español','Los usuarios prestan atención a las notificaciones de alerta/recordatorio en los sistemas electrónicos.'),
      ('KR12','Arabic' ,'ينتبه المستخدمون إلى إشعارات التنبيه/التذكير على الأنظمة الإلكترونية.'),
      -- KR13
      ('KR13','English','The clinical decision support system automatically reports drug interactions.'),
      ('KR13','Español','El sistema de soporte de decisiones clínicas informa automáticamente sobre las interacciones de medicamentos.'),
      ('KR13','Arabic' ,'يقوم نظام دعم القرار السريري بالإبلاغ عن التفاعلات الدوائية تلقائيًا.'),
      -- KR14
      ('KR14','English','All imaging results are instantly presented to the clinical user via the system.'),
      ('KR14','Español','Todos los resultados de imágenes se presentan instantáneamente al usuario clínico a través del sistema.'),
      ('KR14','Arabic' ,'يتم تقديم جميع نتائج التصوير فورًا للمستخدم السريري عبر النظام.'),
      -- KR15
      ('KR15','English','Inpatient units record daily visit notes completely digitally.'),
      ('KR15','Español','Las unidades de hospitalización registran las notas de visita diarias de forma completamente digital.'),
      ('KR15','Arabic' ,'تسجل وحدات المرضى الداخليين ملاحظات الزيارة اليومية بشكل رقمي بالكامل.'),
      -- KR16
      ('KR16','English','Nurse observations are recorded electronically according to defined data fields.'),
      ('KR16','Español','Las observaciones de las enfermeras se registran electrónicamente de acuerdo con campos de datos definidos.'),
      ('KR16','Arabic' ,'يتم تسجيل ملاحظات الممرضات إلكترونيًا وفقًا لحقول البيانات المحددة.'),
      -- KR17
      ('KR17','English','Only authorized personnel have data entry rights according to roles defined in the system.'),
      ('KR17','Español','Solo el personal autorizado tiene derechos de entrada de datos según los roles definidos en el sistema.'),
      ('KR17','Arabic' ,'فقط الموظفون المصرح لهم لديهم حقوق إدخال البيانات وفقًا للأدوار المحددة في النظام.'),
      -- KR18
      ('KR18','English','Laboratory results are directly assigned to the patient, integrated with the order system.'),
      ('KR18','Español','Los resultados de laboratorio se asignan directamente al paciente, integrados con el sistema de órdenes.'),
      ('KR18','Arabic' ,'يتم تعيين نتائج المختبر مباشرة للمريض، متكاملة مع نظام الطلبات.'),
      -- KR19
      ('KR19','English','Consultation requests among clinicians are made through the system.'),
      ('KR19','Español','Las solicitudes de consulta entre clínicos se realizan a través del sistema.'),
      ('KR19','Arabic' ,'تتم طلبات الاستشارة بين الأطباء عبر النظام.'),
      -- KR20
      ('KR20','English','Clinical training programs also include modules on system usage.'),
      ('KR20','Español','Los programas de formación clínica también incluyen módulos sobre el uso del sistema.'),
      ('KR20','Arabic' ,'تتضمن برامج التدريب السريري أيضًا وحدات حول استخدام النظام.'),
      -- KR21
      ('KR21','English','Users use the electronic notification module to report clinical system errors.'),
      ('KR21','Español','Los usuarios utilizan el módulo de notificación electrónica para informar errores del sistema clínico.'),
      ('KR21','Arabic' ,'يستخدم المستخدمون وحدة الإشعارات الإلكترونية للإبلاغ عن أخطاء النظام السريري.'),
      -- KR22
      ('KR22','English','Clinical system performance is regularly monitored with user surveys.'),
      ('KR22','Español','El rendimiento del sistema clínico se supervisa regularmente con encuestas a los usuarios.'),
      ('KR22','Arabic' ,'يتم مراقبة أداء النظام السريري بانتظام من خلال استطلاعات رأي المستخدمين.'),
      -- KR23
      ('KR23','English','Warning algorithms for medication dosage errors are available in the electronic order system.'),
      ('KR23','Español','Existen algoritmos de advertencia para errores de dosificación de medicamentos en el sistema de órdenes electrónicas.'),
      ('KR23','Arabic' ,'تتوفر خوارزميات تحذير لأخطاء جرعات الأدوية في نظام الطلبات الإلكتروني.'),
      -- KR24
      ('KR24','English','Clinical information can be entered via mobile devices.'),
      ('KR24','Español','Se puede ingresar información clínica a través de dispositivos móviles.'),
      ('KR24','Arabic' ,'يمكن إدخال المعلومات السريرية عبر الأجهزة المحمولة.'),
      -- KR25
      ('KR25','English','Clinical users log into the system with 2-step authentication.'),
      ('KR25','Español','Los usuarios clínicos inician sesión en el sistema con autenticación de 2 pasos.'),
      ('KR25','Arabic' ,'يقوم المستخدمون السريريون بتسجيل الدخول إلى النظام من خلال المصادقة الثنائية.'),
      -- KR26
      ('KR26','English','Patient discharge summaries are filled out in a structured way through the system.'),
      ('KR26','Español','Los resúmenes de alta del paciente se completan de forma estructurada a través del sistema.'),
      ('KR26','Arabic' ,'يتم ملء ملخصات خروج المرضى بطريقة منظمة عبر النظام.'),
      -- KR27
      ('KR27','English','The intensive care data set is maintained in a structured format in the system.'),
      ('KR27','Español','El conjunto de datos de cuidados intensivos se mantiene en un formato estructurado en el sistema.'),
      ('KR27','Arabic' ,'يتم الاحتفاظ بمجموعة بيانات العناية المركزة بتنسيق منظم في النظام.'),
      -- KR28
      ('KR28','English','Nurses enter vital signs directly into the system via mobile devices.'),
      ('KR28','Español','Las enfermeras ingresan los signos vitales directamente en el sistema a través de dispositivos móviles.'),
      ('KR28','Arabic' ,'تقوم الممرضات بإدخال العلامات الحيوية مباشرة في النظام عبر الأجهزة المحمولة.'),
      -- KR29
      ('KR29','English','Clinical scores for patient monitoring are calculated automatically.'),
      ('KR29','Español','Las puntuaciones clínicas para el seguimiento del paciente se calculan automáticamente.'),
      ('KR29','Arabic' ,'يتم حساب الدرجات السريرية لمراقبة المريض تلقائيًا.'),
      -- KR30
      ('KR30','English','The system automatically processes data from medical devices into the patient file.'),
      ('KR30','Español','El sistema procesa automáticamente los datos de los dispositivos médicos en el archivo del paciente.'),
      ('KR30','Arabic' ,'يقوم النظام تلقائيًا بمعالجة البيانات من الأجهزة الطبية وإدخالها في ملف المريض.')
  ) AS cv(alias, dil, lang_adi)
     ON cv.alias = tr.kriter_alias
  ON CONFLICT DO NOTHING
)


/* 3) Hızlı Kontrol ------------------------------------------------*/
SELECT dil_adi, COUNT(*) AS kriter_sayisi
FROM   kriterler
GROUP  BY dil_adi
ORDER  BY dil_adi;



/* ============================================================
   GÖSTERGE EKLEME BETİĞİ  
   ============================================================ */

/* 1) Türkçe kök göstergeleri ekle
   ------------------------------------------------------------ */
INSERT INTO gostergeler (
    ust_gosterge_id, gosterge_adi,       gosterge_allias,
    gosterge_etiketleri, gosterge_aciklamasi,
    gosterge_ornek_uygulama, dil_adi, aktif
)
VALUES
 (NULL, 'Klinikte tüm hastalar için elektronik hasta kaydı (EHR) sistemi düzenli olarak kullanılıyor mu?',
        'GS01', 'EHR, kullanım, düzenli', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcıların %95’inden fazlası hasta verisini sistem üzerinden mi giriyor?',
        'GS02', 'kullanıcı, %95, veri girişi', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Elektronik sistem dışında elle tutulan kayıtlar halen mevcut mu?',
        'GS03', 'elle kayıt, kağıt, manuel', NULL, NULL, 'Türkçe', 1),

 (NULL, 'İlaç uygulamaları öncesi hasta kimlik doğrulaması barkod ile yapılıyor mu?',
        'GS04', 'kimlik doğrulama, barkod, ilaç', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Hemşireler ilaç verirken sistem tarafından otomatik uyarı alıyor mu?',
        'GS05', 'hemşire, uyarı, ilaç', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Barkod sisteminin hatalı okuma oranı izleniyor mu?',
        'GS06', 'barkod, hata, izleme', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik personel barkod okutmadan ilaç verebiliyor mu?',
        'GS07', 'barkod, atlama, risk', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Elektronik sistemde barkod okutma zorunlu hale getirildi mi?',
        'GS08', 'barkod, zorunlu, sistem', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik notlar genelde serbest metin olarak mı, yoksa yapılandırılmış alanlarla mı giriliyor?',
        'GS09', 'serbest metin, yapılandırılmış', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Yapılandırılmış veri alanları (örneğin şablonlar, seçmeli kutular) düzenli kullanılıyor mu?',
        'GS10', 'şablon, kutu seçimi, yapılandırılmış', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Doktorlar reçete yazarken CPOE sistemini mi kullanıyor, yoksa manuel giriş var mı?',
        'GS11', 'CPOE, reçete, doktor', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Doktorlar sistem üzerinden verilen order’lara uyarı aldıklarında geri bildirimde bulunuyor mu?',
        'GS12', 'order, uyarı, geri bildirim', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Sistem, doktorun order verirken ilaç etkileşim uyarılarını gösteriyor mu?',
        'GS13', 'ilaç etkileşim, uyarı, order', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Prosedür öncesi “doğru hasta / doğru işlem” kontrolü yapılmakta mı?',
        'GS14', 'check-list, doğru hasta, işlem', NULL, NULL, 'Türkçe', 1),

 (NULL, '“Time-out” kontrol listesi sistemde işaretlenmeden işlem başlatılabiliyor mu?',
        'GS15', 'time-out, check-list, bypass', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Time-out kayıtları sistem tarafından geriye dönük denetlenebiliyor mu?',
        'GS16', 'time-out, denetim, kayıt', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcılar hasta kaydı işlemlerini ortalama ne kadar sürede tamamlıyor?',
        'GS17', 'süre, kayıt, kullanıcı', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik personel her vardiyada en az bir kez hasta bilgisi girişi yapıyor mu?',
        'GS18', 'vardiya, bilgi girişi, sıklık', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Hasta bileklikleri sistemden otomatik olarak mı yazdırılıyor?',
        'GS19', 'bileklik, otomatik, yazdırma', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcılar kendi şifreleri ile sisteme giriş yapıyor mu?',
        'GS20', 'kimlik doğrulama, şifre, kullanıcı', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Hemşireler sisteme düzenli olarak vital bulgu girişini yapıyor mu?',
        'GS21', 'vital, hemşire, giriş', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Hasta izlem planları sistem üzerinden şablonlaştırılmış olarak kaydediliyor mu?',
        'GS22', 'izlem planı, şablon, hasta', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Doktorlar tedavi planlarını sistem üzerinden dijital olarak oluşturabiliyor mu?',
         'GS23', 'tedavi planı, dijital, oluşturma', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik izlem planları hastaya özgü olacak şekilde sistemde tanımlanabiliyor mu?',
         'GS24', 'izlem planı, hasta, tanımlama', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Tedavi sürecindeki değişiklikler doğrudan sistem üzerinde güncelleniyor mu?',
         'GS25', 'tedavi süreci, güncelleme, sistem', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcılar sistemden gelen hatırlatma ve uyarıları dikkate alıyor mu?',
         'GS26', 'hatırlatma, uyarı, dikkate alma', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Bildirim sistemleri (ör. ilaç zamanı uyarısı) kullanıcılar tarafından kapatılabiliyor mu?',
         'GS27', 'bildirim, uyarı, kapatma', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik karar destek sistemi kullanılıyor mu?',
         'GS28', 'karar destek, sistem, kullanım', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Sistem, reçetelenen ilaçlarla hastanın mevcut ilaçları arasında etkileşim kontrolü yapıyor mu?',
         'GS29', 'ilaç etkileşim, kontrol, reçete', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcılar sistemde çıkan uyarılar nedeniyle tedavi planlarını değiştirdi mi?',
         'GS30', 'uyarı, tedavi planı, değişiklik', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Görüntüleme sonuçları PACS gibi sistemlerden otomatik olarak klinik bilgi sistemine aktarılıyor mu?',
         'GS31', 'görüntüleme, PACS, aktarım', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Tüm görüntüleme sonuçlarına klinik sistem üzerinden kolayca erişilebiliyor mu?',
         'GS32', 'görüntüleme, erişim, kolaylık', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Doktorlar görüntüleme sonuçlarını sistem içinden görüntüleyebiliyor mu?',
         'GS33', 'görüntüleme, doktor, erişim', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Yatan hastalarda günlük vizit notları doğrudan sisteme mi yazılıyor?',
         'GS34', 'vizit notu, günlük, sistem', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Vizit notları yapılandırılmış alanlar ile mi dolduruluyor?',
         'GS35', 'vizit notu, yapılandırılmış, alan', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Hemşire gözlemleri belirli şablonlar üzerinden mi giriliyor?',
         'GS36', 'hemşire, gözlem, şablon', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Serbest metin kullanımı dışında sistemde belirlenmiş seçenekler kullanılabiliyor mu?',
         'GS37', 'serbest metin, seçenek, kullanım', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Veri giriş ekranlarında yapılandırılmış alanlar yeterli düzeyde sunuluyor mu?',
         'GS38', 'veri girişi, yapılandırılmış, ekran', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Sistem kullanıcı rolleri doğrultusunda yetki sınırlaması uyguluyor mu?',
         'GS39', 'yetki, rol, sınırlama', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcıların sistemdeki yetkileri rollerine göre otomatik tanımlanıyor mu?',
         'GS40', 'yetki, otomatik, tanımlama', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Kullanıcılar yalnızca kendi yetkileri dahilinde veri girişi yapabiliyor mu?',
         'GS41', 'veri girişi, yetki, kısıtlama', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Laboratuvar sonuçları doğrudan hastanın sistem dosyasına otomatik düşüyor mu?',
         'GS42', 'laboratuvar, sonuç, otomatik', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcılar laboratuvar sonuçlarını sistem içinden görüntüleyebiliyor mu?',
         'GS43', 'laboratuvar, sonuç, görüntüleme', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Konsültasyon talepleri sistem üzerinden gönderilip takip edilebiliyor mu?',
         'GS44', 'konsültasyon, talep, takip', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Konsültasyon kayıtları hasta dosyasına sistem tarafından otomatik bağlanıyor mu?',
         'GS45', 'konsültasyon, kayıt, otomatik', NULL, NULL, 'Türkçe', 1),

(NULL, 'Klinik kullanıcılar sistem üzerinden eğitim modüllerine erişebiliyor mu?',
         'GS46', 'eğitim, modül, erişim', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik bilgi sistemine dair eğitimler kurumsal olarak planlı şekilde veriliyor mu?',
         'GS47', 'eğitim, kurumsal, planlı', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Yeni başlayan sağlık personeline sistem kullanımı eğitimi zorunlu mu?',
         'GS48', 'eğitim, zorunlu, yeni personel', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Kullanıcılar sistemde karşılaştıkları sorunları dijital olarak bildirebiliyor mu?',
         'GS49', 'sorun, bildirim, dijital', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik sistemle ilgili hata ya da öneri bildirimleri elektronik ortamda alınıyor mu?',
         'GS50', 'hata, öneri, bildirim, elektronik', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Bildirilen hatalar sistematik olarak değerlendirilip kayıt altına alınıyor mu?',
         'GS51', 'hata, değerlendirme, kayıt', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Kullanıcı geri bildirimlerine dayanarak sistem güncellemeleri yapılıyor mu?',
         'GS52', 'geri bildirim, güncelleme, sistem', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcı memnuniyeti düzenli anketlerle ölçülüyor mu?',
         'GS53', 'memnuniyet, anket, ölçüm', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Sistem memnuniyeti analiz raporları yönetimle paylaşılıyor mu?',
         'GS54', 'memnuniyet, rapor, yönetim', NULL, NULL, 'Türkçe', 1),

 (NULL, 'İlaç doz hatalarına karşı sistemde uyarı algoritmaları mevcut mu?',
         'GS55', 'doz hatası, uyarı, algoritma', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Kullanıcılar ilaç order’ı verirken sistemden doz sınırı uyarısı alabiliyor mu?',
         'GS56', 'doz sınırı, uyarı, order', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Sistemde yaşa, kiloya veya klinik protokole göre doz önerileri çıkıyor mu?',
         'GS57', 'doz önerisi, yaş, kilo, protokol', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik kullanıcılar mobil cihazlar üzerinden hasta bilgilerine erişebiliyor mu?',
         'GS58', 'mobil, erişim, hasta bilgisi', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Mobil uygulama üzerinden hasta takibi ve veri girişi yapılabiliyor mu?',
         'GS59', 'mobil uygulama, takip, veri girişi', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Mobil sistemlerde de kimlik doğrulama güvenli şekilde uygulanıyor mu?',
         'GS60', 'mobil, kimlik doğrulama, güvenlik', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Klinik sistemlere erişimde iki faktörlü kimlik doğrulama zorunlu mu?',
         'GS61', 'iki faktörlü, kimlik doğrulama, zorunlu', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Kullanıcıların sisteme giriş işlemleri loglanıyor mu?',
         'GS62', 'giriş, işlem, loglama', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Çıkış özeti (epikriz) sistem üzerinden standart şablonla hazırlanıyor mu?',
         'GS63', 'epikriz, şablon, hazırlama', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Epikriz içeriği zorunlu alanlar ile yapılandırılmış şekilde giriliyor mu?',
         'GS64', 'epikriz, zorunlu alan, yapılandırılmış', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Yoğun bakım hastalarına özel veri giriş alanları sistemde mevcut mu?',
         'GS65', 'yoğun bakım, veri girişi, özel alan', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Vital bulgular hemşireler tarafından mobil cihazlarla anlık girilebiliyor mu?',
         'GS66', 'vital bulgu, mobil, anlık giriş', NULL, NULL, 'Türkçe', 1),

 (NULL, 'Hasta skorlamaları sistem tarafından otomatik hesaplanabiliyor mu?',
         'GS67', 'hasta skorlama, otomatik, hesaplama', NULL, NULL, 'Türkçe', 1)

ON CONFLICT DO NOTHING;   -- idempotent


/* ============================================================
   GÖSTERGE ÇEVİRİLERİ  (EN · ES · AR)
   ============================================================ */

WITH tr AS (
  /* Türkçe kök satırları alias ile çekiyoruz */
  SELECT gosterge_id, gosterge_allias
  FROM   gostergeler
  WHERE  dil_adi = 'Türkçe'
)

/* ------------------------------------------------------------
   ÇEVİRİ EKLE
   ------------------------------------------------------------ */
INSERT INTO gostergeler (
    ust_gosterge_id,         -- Türkçe satırın ID’si
    gosterge_adi,            -- Çeviri metni
    gosterge_allias,         -- Alias aynen
    gosterge_etiketleri,     -- Etiketleri TR’den kopyalayabiliriz
    dil_adi,
    aktif
)
SELECT
    tr.gosterge_id,          -- dil bağı
    cv.lang_adi,
    tr.gosterge_allias,
    NULL,                    -- (İstersen tr’den kopya için JOIN yap)
    cv.dil,
    1
FROM tr
JOIN LATERAL (
  /* ============== ÇEVİRİ SÖZLÜĞÜ ===========================
     alias , dil      , çeviri
     ---------------------------------------------------------*/
  VALUES
    -- GS01
    ('GS01','English','Is the electronic health record (EHR) system used routinely for all patients in the clinic?'),
    ('GS01','Español','¿Se utiliza de forma rutinaria el sistema de historia clínica electrónica (HCE) para todos los pacientes de la clínica?'),
    ('GS01','Arabic' ,'هل يُستخدم نظام السجل الطبي الإلكتروني ‎(EHR)‎ بشكل منتظم لجميع المرضى في العيادة؟'),

    -- GS02
    ('GS02','English','Do more than 95% of clinical users enter patient data through the system?'),
    ('GS02','Español','¿Más del 95 % de los usuarios clínicos introduce los datos del paciente a través del sistema?'),
    ('GS02','Arabic' ,'هل يُدخل أكثر من ‎95‎٪ من المستخدمين السريريين بيانات المريض عبر النظام؟'),

    -- GS03
    ('GS03','English','Are paper or manual records still kept outside the electronic system?'),
    ('GS03','Español','¿Se mantienen todavía registros en papel o manuales fuera del sistema electrónico?'),
    ('GS03','Arabic' ,'هل لا تزال توجد سجلات يدوية أو ورقية خارج النظام الإلكتروني؟'),

    -- GS04
    ('GS04','English','Is patient identity verified with a barcode before medication administration?'),
    ('GS04','Español','¿Se verifica la identidad del paciente con un código de barras antes de la administración de medicamentos?'),
    ('GS04','Arabic' ,'هل يتم التحقق من هوية المريض باستخدام الباركود قبل إعطاء الدواء؟'),

    -- GS05
    ('GS05','English','Do nurses receive automatic alerts from the system when administering medication?'),
    ('GS05','Español','¿Reciben las enfermeras alertas automáticas del sistema al administrar medicamentos?'),
    ('GS05','Arabic' ,'هل يتلقى الممرضون تنبيهات تلقائية من النظام عند إعطاء الأدوية؟'),

    -- GS06
    ('GS06','English','Is the barcode system''s mis-read rate monitored?'),
    ('GS06','Español','¿Se supervisa la tasa de lecturas erróneas del sistema de códigos de barras?'),
    ('GS06','Arabic' ,'هل تتم مراقبة معدل قراءات الباركود الخاطئة؟'),

    -- GS07
    ('GS07','English','Can clinical staff administer medication without scanning the barcode?'),
    ('GS07','Español','¿Puede el personal clínico administrar medicamentos sin escanear el código de barras?'),
    ('GS07','Arabic' ,'هل يمكن للطاقم السريري إعطاء الدواء من دون مسح الباركود؟'),

    -- GS08
    ('GS08','English','Has barcode scanning been made mandatory in the electronic system?'),
    ('GS08','Español','¿Se ha hecho obligatorio el escaneo de códigos de barras en el sistema electrónico?'),
    ('GS08','Arabic' ,'هل أصبح مسح الباركود إلزاميًا في النظام الإلكتروني؟'),

    -- GS09
    ('GS09','English','Are clinical notes generally entered as free text or using structured fields?'),
    ('GS09','Español','¿Las notas clínicas se introducen generalmente como texto libre o mediante campos estructurados?'),
    ('GS09','Arabic' ,'هل تُدخل الملاحظات السريرية عادة كنص حر أم عبر حقول مُهيكلة؟'),

    -- GS10
    ('GS10','English','Are structured data elements (e.g., templates, pick-lists) used regularly?'),
    ('GS10','Español','¿Se utilizan regularmente los elementos de datos estructurados (p. ej., plantillas, listas desplegables)?'),
    ('GS10','Arabic' ,'هل تُستخدم بانتظام حقول البيانات المُهيكلة (مثل القوالب وقوائم الاختيار)؟'),

    -- GS11
    ('GS11','English','Do physicians use the CPOE system when prescribing, or is there manual entry?'),
    ('GS11','Español','¿Los médicos utilizan el sistema CPOE al prescribir o existe entrada manual?'),
    ('GS11','Arabic' ,'هل يستخدم الأطباء نظام CPOE عند وصف الدواء أم توجد إدخالات يدوية؟'),

    -- GS12
    ('GS12','English','Do physicians provide feedback when they receive alerts on system orders?'),
    ('GS12','Español','¿Los médicos proporcionan retroalimentación cuando reciben alertas en las órdenes del sistema?'),
    ('GS12','Arabic' ,'هل يقدم الأطباء ملاحظات عند تلقيهم تنبيهات على الأوامر في النظام؟'),

    -- GS13
    ('GS13','English','Does the system display drug-interaction alerts while the physician is ordering?'),
    ('GS13','Español','¿El sistema muestra alertas de interacción medicamentosa mientras el médico ingresa la orden?'),
    ('GS13','Arabic' ,'هل يعرض النظام تنبيهات تداخل الأدوية أثناء إدخال الطبيب للطلب؟'),

    -- GS14
    ('GS14','English','Is the ‘‘right patient / right procedure’’ check performed before procedures?'),
    ('GS14','Español','¿Se realiza la verificación de ''paciente correcto / procedimiento correcto'' antes de los procedimientos?'),
    ('GS14','Arabic' ,'هل يتم إجراء فحص "المريض الصحيح / الإجراء الصحيح" قبل الإجراءات؟'),

    -- GS15
    ('GS15','English','Can a procedure start without the time-out checklist being confirmed in the system?'),
    ('GS15','Español','¿Puede iniciarse un procedimiento sin que se marque la lista de verificación de time-out en el sistema?'),
    ('GS15','Arabic' ,'هل يمكن بدء الإجراء من دون تأكيد قائمة التحقق time-out في النظام؟'),

    -- GS16
    ('GS16','English','Can time-out records be audited retrospectively by the system?'),
    ('GS16','Español','¿Puede el sistema auditar retrospectivamente los registros de time-out?'),
    ('GS16','Arabic' ,'هل يستطيع النظام تدقيق سجلات time-out بأثر رجعي؟'),

    -- GS17
    ('GS17','English','On average, how long do clinical users take to complete patient registration?'),
    ('GS17','Español','¿Cuánto tiempo tardan en promedio los usuarios clínicos en completar el registro del paciente?'),
    ('GS17','Arabic' ,'ما متوسط الوقت الذي يستغرقه المستخدمون السريريين لإتمام تسجيل المريض؟'),

    -- GS18
    ('GS18','English','Does clinical staff enter patient information at least once per shift?'),
    ('GS18','Español','¿El personal clínico introduce información del paciente al menos una vez por turno?'),
    ('GS18','Arabic' ,'هل يقوم الطاقم السريري بإدخال معلومات المريض مرة واحدة على الأقل في كل نوبة؟'),

    -- GS19
    ('GS19','English','Are patient wristbands printed automatically from the system?'),
    ('GS19','Español','¿Las pulseras de identificación del paciente se imprimen automáticamente desde el sistema?'),
    ('GS19','Arabic' ,'هل تُطبع أساور تعريف المريض تلقائيًا من النظام؟'),

    -- GS20
    ('GS20','English','Do clinical users log in to the system with their own passwords?'),
    ('GS20','Español','¿Los usuarios clínicos acceden al sistema con sus propias contraseñas?'),
    ('GS20','Arabic' ,'هل يسجل المستخدمون السريريين الدخول بكلمات المرور الخاصة بهم؟'),

    -- GS21
    ('GS21','English','Do nurses regularly enter vital signs into the system?'),
    ('GS21','Español','¿Las enfermeras registran regularmente los signos vitales en el sistema?'),
    ('GS21','Arabic' ,'هل تقوم الممرضات بإدخال العلامات الحيوية بانتظام في النظام؟'),

    -- GS22
    ('GS22','English','Are patient care plans stored as templated records in the system?'),
    ('GS22','Español','¿Los planes de seguimiento del paciente se guardan como registros con plantillas en el sistema?'),
    ('GS22','Arabic' ,'هل يتم حفظ خطط متابعة المريض كقوالب في النظام؟'),

    -- GS23
    ('GS23', 'English', 'Can physicians digitally create treatment plans through the system?'),
    ('GS23', 'Español', '¿Pueden los médicos crear planes de tratamiento digitalmente a través del sistema?'),
    ('GS23', 'Arabic', 'هل يستطيع الأطباء إنشاء خطط علاج رقميًا عبر النظام؟'),

    -- GS24
    ('GS24', 'English', 'Can clinical monitoring plans be defined in the system to be patient-specific?'),
    ('GS24', 'Español', '¿Se pueden definir los planes de seguimiento clínico en el sistema para que sean específicos del paciente?'),
    ('GS24', 'Arabic', 'هل يمكن تعريف خطط المراقبة السريرية في النظام لتكون خاصة بالمريض؟'),

    -- GS25
    ('GS25', 'English', 'Are changes in the treatment process updated directly within the system?'),
    ('GS25', 'Español', '¿Se actualizan directamente en el sistema los cambios en el proceso de tratamiento?'),
    ('GS25', 'Arabic', 'هل يتم تحديث التغييرات في عملية العلاج مباشرة داخل النظام؟'),

    -- GS26
    ('GS26', 'English', 'Do clinical users take into account reminders and alerts from the system?'),
    ('GS26', 'Español', '¿Tienen en cuenta los usuarios clínicos los recordatorios y alertas del sistema?'),
    ('GS26', 'Arabic', 'هل يأخذ المستخدمون السريريون التذكيرات والتنبيهات من النظام في الاعتبار؟'),

    -- GS27
    ('GS27', 'English', 'Can notification systems (e.g., medication time alerts) be turned off by users?'),
    ('GS27', 'Español', '¿Pueden los usuarios desactivar los sistemas de notificación (por ejemplo, alertas de horario de medicación)?'),
    ('GS27', 'Arabic', 'هل يمكن للمستخدمين إيقاف تشغيل أنظمة الإشعارات (مثل تنبيهات وقت الدواء)؟'),

    -- GS28
    ('GS28', 'English', 'Is a clinical decision support system used?'),
    ('GS28', 'Español', '¿Se utiliza un sistema de apoyo a la toma de decisiones clínicas?'),
    ('GS28', 'Arabic', 'هل يتم استخدام نظام دعم القرار السريري؟'),

    -- GS29
    ('GS29', 'English', 'Does the system check for interactions between prescribed medications and the patient''s current medications?'),
    ('GS29', 'Español', '¿El sistema verifica las interacciones entre los medicamentos recetados y los medicamentos actuales del paciente?'),
    ('GS29', 'Arabic', 'هل يتحقق النظام من التفاعلات بين الأدوية الموصوفة والأدوية الحالية للمريض؟'),

    -- GS30
    ('GS30', 'English', 'Have clinical users changed their treatment plans due to alerts from the system?'),
    ('GS30', 'Español', '¿Los usuarios clínicos han cambiado sus planes de tratamiento debido a las alertas del sistema?'),
    ('GS30', 'Arabic', 'هل قام المستخدمون السريريون بتغيير خطط العلاج الخاصة بهم بسبب التنبيهات من النظام؟'),

    -- GS31
    ('GS31', 'English', 'Are imaging results automatically transferred from systems like PACS to the clinical information system?'),
    ('GS31', 'Español', '¿Se transfieren automáticamente los resultados de imágenes de sistemas como PACS al sistema de información clínica?'),
    ('GS31', 'Arabic', 'هل يتم نقل نتائج التصوير تلقائيًا من أنظمة مثل PACS إلى نظام المعلومات السريرية؟'),

    -- GS32
    ('GS32', 'English', 'Are all imaging results easily accessible through the clinical system?'),
    ('GS32', 'Español', '¿Se puede acceder fácilmente a todos los resultados de imágenes a través del sistema clínico?'),
    ('GS32', 'Arabic', 'هل يمكن الوصول بسهولة إلى جميع نتائج التصوير من خلال النظام السريري؟'),

    -- GS33
    ('GS33', 'English', 'Can physicians view imaging results within the system?'),
    ('GS33', 'Español', '¿Pueden los médicos ver los resultados de las imágenes dentro del sistema?'),
    ('GS33', 'Arabic', 'هل يمكن للأطباء عرض نتائج التصوير من داخل النظام؟'),

    -- GS34
    ('GS34', 'English', 'Are daily visit notes for inpatients written directly into the system?'),
    ('GS34', 'Español', '¿Las notas de visita diarias para pacientes hospitalizados se escriben directamente en el sistema?'),
    ('GS34', 'Arabic', 'هل تُسجل ملاحظات الزيارة اليومية للمرضى المقيمين مباشرة في النظام؟'),

    -- GS35
    ('GS35', 'English', 'Are visit notes filled using structured fields?'),
    ('GS35', 'Español', '¿Las notas de visita se rellenan utilizando campos estructurados?'),
    ('GS35', 'Arabic', 'هل تُملأ ملاحظات الزيارة باستخدام حقول مُهيكلة؟'),

    -- GS36
    ('GS36', 'English', 'Are nursing observations entered through specific templates?'),
    ('GS36', 'Español', '¿Las observaciones de enfermería se introducen a través de plantillas específicas?'),
    ('GS36', 'Arabic', 'هل تُدخل ملاحظات التمريض عبر قوالب محددة؟'),

    -- GS37
    ('GS37', 'English', 'Can predefined options be used in the system, aside from free text entry?'),
    ('GS37', 'Español', '¿Se pueden utilizar opciones predefinidas en el sistema, además de la entrada de texto libre?'),
    ('GS37', 'Arabic', 'هل يمكن استخدام خيارات محددة في النظام، بخلاف إدخال النص الحر؟'),

    -- GS38
    ('GS38', 'English', 'Are structured fields sufficiently provided on data entry screens?'),
    ('GS38', 'Español', '¿Se proporcionan suficientes campos estructurados en las pantallas de entrada de datos?'),
    ('GS38', 'Arabic', 'هل يتم توفير حقول مُهيكلة بشكل كافٍ في شاشات إدخال البيانات؟'),

    -- GS39
    ('GS39', 'English', 'Does the system apply authorization restrictions based on user roles?'),
    ('GS39', 'Español', '¿El sistema aplica restricciones de autorización según los roles de usuario?'),
    ('GS39', 'Arabic', 'هل يطبق النظام قيود الصلاحيات بناءً على أدوار المستخدمين؟'),

    -- GS40
    ('GS40', 'English', 'Are clinical users'' system authorizations automatically defined according to their roles?'),
    ('GS40', 'Español', '¿Se definen automáticamente las autorizaciones del sistema para los usuarios clínicos según sus roles?'),
    ('GS40', 'Arabic', 'هل تُعرف صلاحيات مستخدمي النظام السريريين تلقائيًا وفقًا لأدوارهم؟'),

    -- GS41
    ('GS41', 'English', 'Can users only enter data within their authorized permissions?'),
    ('GS41', 'Español', '¿Pueden los usuarios ingresar datos solo dentro de sus permisos autorizados?'),
    ('GS41', 'Arabic', 'هل يمكن للمستخدمين إدخال البيانات ضمن صلاحياتهم المصرح بها فقط؟'),

    -- GS42
    ('GS42', 'English', 'Are laboratory results automatically entered directly into the patient''s system file?'),
    ('GS42', 'Español', '¿Los resultados de laboratorio se ingresan automáticamente directamente en el archivo del sistema del paciente?'),
    ('GS42', 'Arabic', 'هل تسجل نتائج المختبر تلقائيًا مباشرة في ملف المريض في النظام؟'),

    -- GS43
    ('GS43', 'English', 'Can clinical users view laboratory results within the system?'),
    ('GS43', 'Español', '¿Pueden los usuarios clínicos ver los resultados de laboratorio dentro del sistema?'),
    ('GS43', 'Arabic', 'هل يمكن للمستخدمين السريريين عرض نتائج المختبر من داخل النظام؟'),

    -- GS44
    ('GS44', 'English', 'Can consultation requests be sent and tracked through the system?'),
    ('GS44', 'Español', '¿Se pueden enviar y seguir las solicitudes de consulta a través del sistema?'),
    ('GS44', 'Arabic', 'هل يمكن إرسال طلبات الاستشارة وتتبعها عبر النظام؟'),

    -- GS45
    ('GS45', 'English', 'Are consultation records automatically linked to the patient file by the system?'),
    ('GS45', 'Español', '¿Los registros de consulta se vinculan automáticamente al archivo del paciente por el sistema?'),
    ('GS45', 'Arabic', 'هل يتم ربط سجلات الاستشارة تلقائيًا بملف المريض بواسطة النظام؟'),

    -- GS46
    ('GS46', 'English', 'Can clinical users access training modules through the system?'),
    ('GS46', 'Español', '¿Pueden los usuarios clínicos acceder a los módulos de capacitación a través del sistema?'),
    ('GS46', 'Arabic', 'هل يستطيع المستخدمون السريريون الوصول إلى وحدات التدريب عبر النظام؟'),

    -- GS47
    ('GS47', 'English', 'Are trainings related to the clinical information system provided institutionally and in a planned manner?'),
    ('GS47', 'Español', '¿Se ofrecen capacitaciones relacionadas con el sistema de información clínica de manera institucional y planificada?'),
    ('GS47', 'Arabic', 'هل يتم تقديم تدريبات متعلقة بنظام المعلومات السريرية بشكل مؤسسي ومخطط؟'),

    -- GS48
    ('GS48', 'English', 'Is system usage training mandatory for newly hired healthcare personnel?'),
    ('GS48', 'Español', '¿Es obligatorio el entrenamiento en el uso del sistema para el personal de salud recién incorporado?'),
    ('GS48', 'Arabic', 'هل التدريب على استخدام النظام إلزامي للموظفين الصحيين الجدد؟'),

    -- GS49
    ('GS49', 'English', 'Can users digitally report problems they encounter in the system?'),
    ('GS49', 'Español', '¿Pueden los usuarios reportar digitalmente los problemas que encuentran en el sistema?'),
    ('GS49', 'Arabic', 'هل يستطيع المستخدمون الإبلاغ رقميًا عن المشاكل التي يواجهونها في النظام؟'),

    -- GS50
    ('GS50', 'English', 'Are error or suggestion notifications related to the clinical system received electronically?'),
    ('GS50', 'Español', '¿Se reciben electrónicamente las notificaciones de errores o sugerencias relacionadas con el sistema clínico?'),
    ('GS50', 'Arabic', 'هل يتم تلقي إشعارات الأخطاء أو الاقتراحات المتعلقة بالنظام السريري إلكترونيًا؟'),

	-- GS51
    ('GS51', 'English', 'Are reported errors systematically evaluated and recorded?'),
    ('GS51', 'Español', '¿Se evalúan y registran sistemáticamente los errores reportados?'),
    ('GS51', 'Arabic', 'هل يتم تقييم الأخطاء المبلغ عنها وتسجيلها بشكل منهجي؟'),

    -- GS52
    ('GS52', 'English', 'Are system updates made based on user feedback?'),
    ('GS52', 'Español', '¿Se realizan actualizaciones del sistema basadas en los comentarios de los usuarios?'),
    ('GS52', 'Arabic', 'هل يتم تحديث النظام بناءً على ملاحظات المستخدمين؟'),

    -- GS53
    ('GS53', 'English', 'Is clinical user satisfaction measured with regular surveys?'),
    ('GS53', 'Español', '¿Se mide la satisfacción del usuario clínico con encuestas regulares?'),
    ('GS53', 'Arabic', 'هل يتم قياس رضا المستخدمين السريريين من خلال استبيانات منتظمة؟'),

    -- GS54
    ('GS54', 'English', 'Are system satisfaction analysis reports shared with management?'),
    ('GS54', 'Español', '¿Se comparten los informes de análisis de satisfacción del sistema con la dirección?'),
    ('GS54', 'Arabic', 'هل تتم مشاركة تقارير تحليل رضا النظام مع الإدارة؟'),

    -- GS55
    ('GS55', 'English', 'Are there warning algorithms in the system against medication dosage errors?'),
    ('GS55', 'Español', '¿Existen algoritmos de advertencia en el sistema contra errores en la dosificación de medicamentos?'),
    ('GS55', 'Arabic', 'هل توجد خوارزميات تحذير في النظام ضد أخطاء جرعات الأدوية؟'),

    -- GS56
    ('GS56', 'English', 'Can users receive dosage limit warnings from the system when ordering medication?'),
    ('GS56', 'Español', '¿Pueden los usuarios recibir advertencias de límite de dosis del sistema al solicitar medicamentos?'),
    ('GS56', 'Arabic', 'هل يمكن للمستخدمين تلقي تنبيهات حدود الجرعات من النظام عند طلب الأدوية؟'),

    -- GS57
    ('GS57', 'English', 'Does the system provide dosage recommendations based on age, weight, or clinical protocol?'),
    ('GS57', 'Español', '¿El sistema proporciona recomendaciones de dosis basadas en la edad, el peso o el protocolo clínico?'),
    ('GS57', 'Arabic', 'هل يقدم النظام توصيات للجرعات بناءً على العمر، الوزن أو البروتوكول السريري؟'),

    -- GS58
    ('GS58', 'English', 'Can clinical users access patient information via mobile devices?'),
    ('GS58', 'Español', '¿Pueden los usuarios clínicos acceder a la información del paciente a través de dispositivos móviles?'),
    ('GS58', 'Arabic', 'هل يستطيع المستخدمون السريريون الوصول إلى معلومات المريض عبر الأجهزة المحمولة؟'),

    -- GS59
    ('GS59', 'English', 'Can patient tracking and data entry be done via the mobile application?'),
    ('GS59', 'Español', '¿Se puede realizar el seguimiento de pacientes y la entrada de datos a través de la aplicación móvil?'),
    ('GS59', 'Arabic', 'هل يمكن تتبع المرضى وإدخال البيانات عبر تطبيق الجوال؟'),

    -- GS60
    ('GS60', 'English', 'Is identity verification securely implemented in mobile systems as well?'),
    ('GS60', 'Español', '¿Se implementa la verificación de identidad de forma segura también en los sistemas móviles?'),
    ('GS60', 'Arabic', 'هل يتم تطبيق التحقق من الهوية بشكل آمن في الأنظمة المحمولة أيضًا؟'),

    -- GS61
    ('GS61', 'English', 'Is two-factor authentication mandatory for accessing clinical systems?'),
    ('GS61', 'Español', '¿Es obligatoria la autenticación de dos factores para acceder a los sistemas clínicos?'),
    ('GS61', 'Arabic', 'هل المصادقة الثنائية إلزامية للوصول إلى الأنظمة السريرية؟'),

    -- GS62
    ('GS62', 'English', 'Are user login activities to the system logged?'),
    ('GS62', 'Español', '¿Se registran las actividades de inicio de sesión de los usuarios en el sistema?'),
    ('GS62', 'Arabic', 'هل يتم تسجيل عمليات تسجيل دخول المستخدمين إلى النظام؟'),

    -- GS63
    ('GS63', 'English', 'Is the discharge summary (epicrisis) prepared using a standard template through the system?'),
    ('GS63', 'Español', '¿El resumen de alta (epicrisis) se prepara utilizando una plantilla estándar a través del sistema?'),
    ('GS63', 'Arabic', 'هل يتم إعداد ملخص الخروج (التقارير الطبية) عبر النظام باستخدام قالب قياسي؟'),

    -- GS64
    ('GS64', 'English', 'Is the epicrisis content entered in a structured way with mandatory fields?'),
    ('GS64', 'Español', '¿El contenido de la epicrisis se ingresa de forma estructurada con campos obligatorios?'),
    ('GS64', 'Arabic', 'هل يتم إدخال محتوى التقرير الطبي بشكل مهيكل مع حقول إلزامية؟'),

    -- GS65
    ('GS65', 'English', 'Are there specific data entry fields in the system for intensive care patients?'),
    ('GS65', 'Español', '¿Existen campos de entrada de datos específicos en el sistema para pacientes de cuidados intensivos?'),
    ('GS65', 'Arabic', 'هل توجد حقول إدخال بيانات خاصة بمرضى العناية المركزة في النظام؟'),

    -- GS66
    ('GS66', 'English', 'Can vital signs be entered instantly by nurses using mobile devices?'),
    ('GS66', 'Español', '¿Pueden las enfermeras ingresar los signos vitales al instante utilizando dispositivos móviles?'),
    ('GS66', 'Arabic', 'هل يمكن للممرضات إدخال العلامات الحيوية فورًا باستخدام الأجهزة المحمولة؟'),

    -- GS67
    ('GS67', 'English', 'Can patient scores be automatically calculated by the system?'),
    ('GS67', 'Español', '¿El sistema puede calcular automáticamente las puntuaciones de los pacientes?'),
    ('GS67', 'Arabic', 'هل يمكن للنظام حساب درجات المرضى تلقائيًا؟')
  /* ---------------------------------------------------------- */
) AS cv(alias, dil, lang_adi)
   ON cv.alias = tr.gosterge_allias
ON CONFLICT DO NOTHING;

/* ------------------------------------------------------------
   KONTROL: dil başına gösterge sayısı
   ------------------------------------------------------------ */
SELECT dil_adi, COUNT(*) AS gosterge_sayisi
FROM   gostergeler
GROUP  BY dil_adi
ORDER  BY dil_adi;


select * from gostergeler;


/* ------------------------------------------------------------
   Gösterge Cevap Türleri – temel 5 tür
   ------------------------------------------------------------ */



/* 1) Veri ekleme – idempotent */
INSERT INTO gosterge_cevap_turleri (gosterge_cevap_turu)
VALUES
  ('Evet / Hayır'),          -- Binary (Yes/No)
  ('Likert 5’li'),           -- Likert scale (Strongly disagree … Strongly agree)
  ('Yüzdelik Değer'),        -- Percentage (0–100 %)
  ('Sayısal (Tam / Ondalık)'),-- Numeric entry
  ('Serbest Metin')          -- Free-text / comment
ON CONFLICT DO NOTHING;

/* 2) Kontrol – kaç tür var? */
SELECT * FROM gosterge_cevap_turleri;



/* ============================================================
   GÖSTERGE CEVAP ŞABLONLARI  –  TR kök  +  EN çeviri
   ============================================================ */

/* ------------------------------------------------------------
    1) TÜRKÇE KÖK ŞABLONLAR
    ------------------------------------------------------------ */
/* 1) Yardımcı CTE – cevap türü ID’lerini çeker (E/H = 1, Likert = 2 ...) */
WITH cvt AS (
    SELECT
        gosterge_cevap_turu_id,
        gosterge_cevap_turu
    FROM gosterge_cevap_turleri
),

tr AS (
    INSERT INTO gosterge_cevap_sablonlari (
        ust_gosterge_cevap_sablonu_id,    -- kök: NULL
        gosterge_cevap_turu_id,
        gosterge_cevap_sablon_adi,
        gosterge_cevap_adi,
        gosterge_cevap_puani,
        dil_adi
    )
    /* ---- İKİLİ CEVAP -----------------------------------------*/
    SELECT CAST(NULL AS INTEGER), -- Burası düzeltildi!
           (SELECT gosterge_cevap_turu_id FROM cvt WHERE gosterge_cevap_turu = 'Evet / Hayır'),
           'İkili Cevap',
           txt,
           puan,
           'Türkçe'
    FROM (VALUES ('Evet',100),('Hayır',0)) AS eh(txt,puan)

    UNION ALL
    /* ---- LİKERT 5’Lİ -----------------------------------------*/
    SELECT CAST(NULL AS INTEGER), -- Burası düzeltildi!
           (SELECT gosterge_cevap_turu_id FROM cvt WHERE gosterge_cevap_turu = 'Likert 5’li'),
           'Likert 5''li',
           txt,
           puan,
           'Türkçe'
    FROM (VALUES
             ('Kesinlikle Katılıyorum',100),
             ('Katılıyorum',75),
             ('Kararsızım',50),
             ('Katılmıyorum',25),
             ('Kesinlikle Katılmıyorum',0)
        ) AS lk(txt,puan)
    ON CONFLICT DO NOTHING
    RETURNING gosterge_cevap_sablonu_id, gosterge_cevap_sablon_adi,
              gosterge_cevap_adi, gosterge_cevap_puani, gosterge_cevap_turu_id
),

/* ------------------------------------------------------------
    2) İNGİLİZCE ÇEVİRİLER
    ------------------------------------------------------------ */
ins_translations AS (
    INSERT INTO gosterge_cevap_sablonlari (
        ust_gosterge_cevap_sablonu_id,
        gosterge_cevap_turu_id,
        gosterge_cevap_sablon_adi,
        gosterge_cevap_adi,
        gosterge_cevap_puani,
        dil_adi
    )
    SELECT
        tr.gosterge_cevap_sablonu_id,      -- dil bağı
        tr.gosterge_cevap_turu_id,
        CASE tr.gosterge_cevap_sablon_adi
            WHEN 'İkili Cevap'  THEN 'Two-Answer'
            WHEN 'Likert 5''li' THEN 'Likert-5'
        END                                         AS sablon_en,
        cv.en_txt                                   AS cevap_en,
        tr.gosterge_cevap_puani,
        'English'
    FROM tr
    JOIN LATERAL (
        VALUES
            ('Evet','Yes'),
            ('Hayır','No'),
            ('Kesinlikle Katılıyorum','Strongly Agree'),
            ('Katılıyorum','Agree'),
            ('Kararsızım','Neutral'),
            ('Katılmıyorum','Disagree'),
            ('Kesinlikle Katılmıyorum','Strongly Disagree')
    ) AS cv(tr_txt,en_txt)
        ON cv.tr_txt = tr.gosterge_cevap_adi

    UNION ALL

    SELECT
        tr.gosterge_cevap_sablonu_id,      -- dil bağı
        tr.gosterge_cevap_turu_id,
        CASE tr.gosterge_cevap_sablon_adi
            WHEN 'İkili Cevap'  THEN 'Respuesta Doble'
            WHEN 'Likert 5''li' THEN 'Likert-5'
        END                                         AS sablon_es,
        cv.es_txt                                   AS cevap_es,
        tr.gosterge_cevap_puani,
        'Español'
    FROM tr
    JOIN LATERAL (
        VALUES
            ('Evet','Sí'),
            ('Hayır','No'),
            ('Kesinlikle Katılıyorum','Totalmente de acuerdo'),
            ('Katılıyorum','De acuerdo'),
            ('Kararsızım','Neutral'),
            ('Katılmıyorum','En desacuerdo'),
            ('Kesinlikle Katılmıyorum','Totalmente en desacuerdo')
    ) AS cv(tr_txt,es_txt)
        ON cv.tr_txt = tr.gosterge_cevap_adi

    UNION ALL

    SELECT
        tr.gosterge_cevap_sablonu_id,      -- dil bağı
        tr.gosterge_cevap_turu_id,
        CASE tr.gosterge_cevap_sablon_adi
            WHEN 'İkili Cevap'  THEN 'إجابة ثنائية'
            WHEN 'Likert 5''li' THEN 'ليكرت-5'
        END                                         AS sablon_ar,
        cv.ar_txt                                   AS cevap_ar,
        tr.gosterge_cevap_puani,
        'Arabic'
    FROM tr
    JOIN LATERAL (
        VALUES
            ('Evet','نعم'),
            ('Hayır','لا'),
            ('Kesinlikle Katılıyorum','أتفق بشدة'),
            ('Katılıyorum','أتفق'),
            ('Kararsızım','محايد'),
            ('Katılmıyorum','لا أتفق'),
            ('Kesinlikle Katılmıyorum','لا أتفق بشدة')
    ) AS cv(tr_txt,ar_txt)
        ON cv.tr_txt = tr.gosterge_cevap_adi
    ON CONFLICT DO NOTHING
)

/* ------------------------------------------------------------
    3) KONTROL – Dil başına şablon sayısı
    ------------------------------------------------------------ */
SELECT dil_adi, COUNT(*) AS sablon_sayisi
FROM    gosterge_cevap_sablonlari
GROUP BY dil_adi
ORDER BY dil_adi;








